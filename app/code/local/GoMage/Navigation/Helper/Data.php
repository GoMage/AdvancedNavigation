<?php eval(base64_decode("LyoqICogR29NYWdlIEFkdmFuY2VkIE5hdmlnYXRpb24gRXh0ZW5zaW9uICogKiBAY2F0ZWdvcnkgRXh0ZW5zaW9uICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTAtMjAxNCBHb01hZ2UgKGh0dHA6Ly93d3cuZ29tYWdlLmNvbSkgKiBAYXV0aG9yIEdvTWFnZSAqIEBsaWNlbnNlIGh0dHA6Ly93d3cuZ29tYWdlLmNvbS9saWNlbnNlLWFncmVlbWVudC8gU2luZ2xlIGRvbWFpbiBsaWNlbnNlICogQHRlcm1zIG9mIHVzZSBodHRwOi8vd3d3LmdvbWFnZS5jb20vdGVybXMtb2YtdXNlICogQHZlcnNpb24gUmVsZWFzZTogNC4zICogQHNpbmNlIENsYXNzIGF2YWlsYWJsZSBzaW5jZSBSZWxlYXNlIDEuMCAqLyByZXF1aXJlX29uY2UoTWFnZTo6Z2V0QmFzZURpcignbGliJykgLiBEUyAuICdHb01hZ2UnIC4gRFMgLiAnTW9iaWxlRGV0ZWN0JyAuIERTIC4gJ01vYmlsZV9EZXRlY3QucGhwJyk7IGNsYXNzIEdvTWFnZV9OYXZpZ2F0aW9uX0hlbHBlcl9EYXRhIGV4dGVuZHMgTWFnZV9Db3JlX0hlbHBlcl9BYnN0cmFjdCB7IHB1YmxpYyBmdW5jdGlvbiBnZXRDb25maWdEYXRhKCRub2RlKSB7IHJldHVybiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vJyAuICRub2RlKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QWxsU3RvcmVEb21haW5zKCkgeyAkZG9tYWlucyA9IGFycmF5KCk7IGZvcmVhY2ggKE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlcygpIGFzICR3ZWJzaXRlKSB7ICR1cmwgPSAkd2Vic2l0ZS0+Z2V0Q29uZmlnKCd3ZWIvdW5zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gJHVybCA9ICR3ZWJzaXRlLT5nZXRDb25maWcoJ3dlYi9zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gfSByZXR1cm4gYXJyYXlfdW5pcXVlKCRkb21haW5zKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhYmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX3coKSB7IGlmICghTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi9pbnN0YWxsZWQnKSB8fCAoaW50dmFsKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vY291bnQnKSkgPiAxMCkgKSB7IHJldHVybiBhcnJheSgpOyB9ICR0aW1lX3RvX3VwZGF0ZSA9IDYwICogNjAgKiAyNCAqIDE1OyAkciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKTsgJHQgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3RpbWUnKTsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3dlYnNpdGVzJyk7ICRsYXN0X2NoZWNrID0gc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkdCkpOyAkYWxsc2l0ZXMgPSBleHBsb2RlKCcsJywgc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkcykpKTsgJGFsbHNpdGVzID0gYXJyYXlfZGlmZigkYWxsc2l0ZXMsIGFycmF5KCIiKSk7IGlmICgoJGxhc3RfY2hlY2sgKyAkdGltZV90b191cGRhdGUpIDwgdGltZSgpKSB7ICR0aGlzLT5hKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24va2V5JyksIGludHZhbChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2NvdW50JykpLCBpbXBsb2RlKCcsJywgJGFsbHNpdGVzKSApOyB9IHJldHVybiAkYWxsc2l0ZXM7IH0gcHVibGljIGZ1bmN0aW9uIGEoJGssICRjID0gMCwgJHMgPSAnJykgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX2Rvd25sb2FkYWJsZS9rZXkvY2hlY2snKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICdrZXk9JyAuIHVybGVuY29kZSgkaykgLiAnJnNrdT1hZHZhbmNlZC1uYXZpZ2F0aW9uJmRvbWFpbnM9JyAuIHVybGVuY29kZShpbXBsb2RlKCcsJywgJHRoaXMtPmdldEFsbFN0b3JlRG9tYWlucygpKSkgLiAnJnZlcj0nIC4gdXJsZW5jb2RlKCc0LjMnKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAzMCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgMCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZSE9TVCwgMCk7ICRjb250ZW50ID0gY3VybF9leGVjKCRjaCk7ICRyID0gWmVuZF9Kc29uOjpkZWNvZGUoJGNvbnRlbnQpOyAkZSA9IE1hZ2U6OmhlbHBlcignY29yZScpOyBpZiAoZW1wdHkoJHIpKSB7ICR2YWx1ZTEgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2FyJyk7ICRncm91cHMgPSBhcnJheSggJ2FkdmFuY2VkbmF2aWdhdGlvbicgPT4gYXJyYXkoICdmaWVsZHMnID0+IGFycmF5KCAnYXInID0+IGFycmF5KCAndmFsdWUnID0+ICR2YWx1ZTEgKSwgJ3dlYnNpdGVzJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKU1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vd2Vic2l0ZXMnKSApLCAndGltZScgPT4gYXJyYXkoICd2YWx1ZScgPT4gKHN0cmluZykkZS0+ZW5jcnlwdCgkdmFsdWUxIC4gKHRpbWUoKSAtICg2MCAqIDYwICogMjQgKiAxNSAtIDE4MDApKSAuICR2YWx1ZTEpICksICdjb3VudCcgPT4gYXJyYXkoICd2YWx1ZScgPT4gJGMgKyAxKSApICkgKTsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWluaHRtbC9jb25maWdfZGF0YScpIC0+c2V0U2VjdGlvbignZ29tYWdlX2FjdGl2YXRpb24nKSAtPnNldEdyb3VwcygkZ3JvdXBzKSAtPnNhdmUoKTsgTWFnZTo6Z2V0Q29uZmlnKCktPnJlaW5pdCgpOyBNYWdlOjphcHAoKS0+cmVpbml0U3RvcmVzKCk7IHJldHVybjsgfSAkdmFsdWUxID0gJyc7ICR2YWx1ZTIgPSAnJzsgaWYgKGlzc2V0KCRyWydkJ10pICYmIGlzc2V0KCRyWydjJ10pKSB7ICR2YWx1ZTEgPSAkZS0+ZW5jcnlwdChiYXNlNjRfZW5jb2RlKFplbmRfSnNvbjo6ZW5jb2RlKCRyKSkpOyBpZiAoISRzKSB7ICRzID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi93ZWJzaXRlcycpOyB9ICRzID0gYXJyYXlfc2xpY2UoZXhwbG9kZSgnLCcsICRzKSwgMCwgJHJbJ2MnXSk7ICR2YWx1ZTIgPSAkZS0+ZW5jcnlwdCgkdmFsdWUxIC4gaW1wbG9kZSgnLCcsICRzKSAuICR2YWx1ZTEpOyB9ICRncm91cHMgPSBhcnJheSggJ2FkdmFuY2VkbmF2aWdhdGlvbicgPT4gYXJyYXkoICdmaWVsZHMnID0+IGFycmF5KCAnYXInID0+IGFycmF5KCAndmFsdWUnID0+ICR2YWx1ZTEgKSwgJ3dlYnNpdGVzJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKSR2YWx1ZTIgKSwgJ3RpbWUnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpJGUtPmVuY3J5cHQoJHZhbHVlMSAuIHRpbWUoKSAuICR2YWx1ZTEpICksICdpbnN0YWxsZWQnID0+IGFycmF5KCAndmFsdWUnID0+IDEgKSwgJ2NvdW50JyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAwKSApICkgKTsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWluaHRtbC9jb25maWdfZGF0YScpIC0+c2V0U2VjdGlvbignZ29tYWdlX2FjdGl2YXRpb24nKSAtPnNldEdyb3VwcygkZ3JvdXBzKSAtPnNhdmUoKTsgTWFnZTo6Z2V0Q29uZmlnKCktPnJlaW5pdCgpOyBNYWdlOjphcHAoKS0+cmVpbml0U3RvcmVzKCk7IH0gcHVibGljIGZ1bmN0aW9uIGdhKCkgeyByZXR1cm4gWmVuZF9Kc29uOjpkZWNvZGUoYmFzZTY0X2RlY29kZShNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2FyJykpKSk7IH0gcHVibGljIGZ1bmN0aW9uIGlzR29tYWdlTmF2aWdhdGlvbigpIHsgaWYgKCR0aGlzLT5pc01vYmlsZURldmljZSgpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZ2VuZXJhbC9kaXNhYmxlX21vYmlsZScpKSB7IHJldHVybiBmYWxzZTsgfSByZXR1cm4gaW5fYXJyYXkoTWFnZTo6YXBwKCktPmdldFN0b3JlKCktPmdldFdlYnNpdGVJZCgpLCAkdGhpcy0+Z2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSkgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9nZW5lcmFsL21vZGUnKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uTWVudSgpIHsgcmV0dXJuIGluX2FycmF5KE1hZ2U6OmFwcCgpLT5nZXRTdG9yZSgpLT5nZXRXZWJzaXRlSWQoKSwgJHRoaXMtPmdldEF2YWlsYXZlbFdlYnNpdGVzKCkpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vbWVudWJhcnNldHRpbmdzL25hdmlnYXRpb24nKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uQWpheCgpIHsgcmV0dXJuICR0aGlzLT5pc0dvbWFnZU5hdmlnYXRpb24oKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2dlbmVyYWwvcGFnZXInKSAmJiAoTWFnZTo6cmVnaXN0cnkoJ2N1cnJlbnRfY2F0ZWdvcnknKSB8fCAoTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCktPmdldFJvdXRlTmFtZSgpID09ICdjYXRhbG9nc2VhcmNoJyAmJiBNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Q29udHJvbGxlck5hbWUoKSAhPSAnYWR2YW5jZWQnKSk7IH0gcHVibGljIGZ1bmN0aW9uIGlzR29tYWdlTmF2aWdhdGlvbkNsZWFyQWpheCgpIHsgcmV0dXJuICR0aGlzLT5pc0dvbWFnZU5hdmlnYXRpb24oKSAmJiAoTWFnZTo6cmVnaXN0cnkoJ2N1cnJlbnRfY2F0ZWdvcnknKSB8fCAoTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCktPmdldFJvdXRlTmFtZSgpID09ICdjYXRhbG9nc2VhcmNoJyAmJiBNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Q29udHJvbGxlck5hbWUoKSAhPSAnYWR2YW5jZWQnKSk7IH0gcHVibGljIGZ1bmN0aW9uIGZvcm1hdENvbG9yKCR2YWx1ZSkgeyBpZiAoJHZhbHVlID0gcHJlZ19yZXBsYWNlKCcvW15hLXpBLVowLTlcc10vJywgJycsICR2YWx1ZSkpIHsgJHZhbHVlID0gJyMnIC4gJHZhbHVlOyB9IHJldHVybiAkdmFsdWU7IH0gcHVibGljIGZ1bmN0aW9uIGlzRnJlbmRseVVybCgpIHsgcmV0dXJuICR0aGlzLT5pc0dvbWFnZU5hdmlnYXRpb24oKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlcl9zZXR0aW5ncy9mcmVuZGx5dXJsJykgJiYgISR0aGlzLT5pc0dvTWFnZV9TZW9Cb29zdGVyRW5hYmxlZCgpOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0dvTWFnZV9TZW9Cb29zdGVyRW5hYmxlZCgpIHsgJF9tb2R1bGVzID0gTWFnZTo6Z2V0Q29uZmlnKCktPmdldE5vZGUoJ21vZHVsZXMnKS0+Y2hpbGRyZW4oKTsgJF9tb2R1bGVzQXJyYXkgPSAoYXJyYXkpJF9tb2R1bGVzOyBpZiAoIWlzc2V0KCRfbW9kdWxlc0FycmF5WydHb01hZ2VfU2VvQm9vc3RlciddKSkgeyByZXR1cm4gZmFsc2U7IH0gcmV0dXJuICRfbW9kdWxlc0FycmF5WydHb01hZ2VfU2VvQm9vc3RlciddLT5pcygnYWN0aXZlJyk7IH0gcHVibGljIGZ1bmN0aW9uIGdldEZpbHRlclVybCgkcm91dGUgPSAnJywgJHBhcmFtcyA9IGFycmF5KCksICRmaWx0ZXIgPSBmYWxzZSkgeyBpZiAoISR0aGlzLT5pc0ZyZW5kbHlVcmwoKSkgeyAkdXJsID0gTWFnZTo6Z2V0VXJsKCRyb3V0ZSwgJHBhcmFtcyk7ICRhcnIgPSBwYXJzZV91cmwoJHVybCk7ICRxdWVyeVN0cmluZyA9IGZhbHNlOyBpZiAoaXNzZXQoJGFyclsncXVlcnknXSkpIHsgcGFyc2Vfc3RyKGh0bWxzcGVjaWFsY2hhcnNfZGVjb2RlKCRhcnJbJ3F1ZXJ5J10pLCAkcGFyKTsgaWYgKGlzc2V0KCRwYXJbJ2FqYXgnXSkpIHsgdW5zZXQoJHBhclsnYWpheCddKTsgfSAkcXVlcnlTdHJpbmcgPSBodHRwX2J1aWxkX3F1ZXJ5KCRwYXIpOyB9ICRwb3J0ID0gJyc7IGlmIChpc3NldCgkYXJyWydwb3J0J10pICYmICRhcnJbJ3BvcnQnXSAhPT0gJzgwJykgeyAkcG9ydCA9ICc6JyAuICRhcnJbJ3BvcnQnXTsgfSAkdXJsID0gJGFyclsnc2NoZW1lJ10gLiAnOi8vJyAuICRhcnJbJ2hvc3QnXSAuICRwb3J0IC4gJGFyclsncGF0aCddIC4gJz8nOyBpZiAoJHF1ZXJ5U3RyaW5nKSB7ICR1cmwgLj0gJHF1ZXJ5U3RyaW5nOyB9IHJldHVybiAkdXJsOyB9ICRtb2RlbCA9IE1hZ2U6OmdldE1vZGVsKCdjb3JlL3VybCcpOyAkcmVxdWVzdF9xdWVyeSA9ICRtb2RlbC0+Z2V0UmVxdWVzdCgpLT5nZXRRdWVyeSgpOyAkYXR0ciA9IE1hZ2U6OnJlZ2lzdHJ5KCdnYW5fZmlsdGVyX2F0dHJpYnV0ZXMnKTsgZm9yZWFjaCAoJG1vZGVsLT5nZXRSZXF1ZXN0KCktPmdldFF1ZXJ5KCkgYXMgJHBhcmFtID0+ICR2YWx1ZSkgeyAkYXR0cmlidXRlTW9kZWwgPSBNYWdlOjpnZXRNb2RlbCgnZWF2L2VudGl0eV9hdHRyaWJ1dGUnKS0+bG9hZEJ5Q29kZSgnY2F0YWxvZ19wcm9kdWN0JywgJHBhcmFtKTsgaWYgKCRwYXJhbSA9PSAnY2F0JykgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyAkY2F0ZWdvcnkgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9jYXRlZ29yeScpLT5sb2FkKCRfdmFsdWUpOyBpZiAoJGNhdGVnb3J5ICYmICRjYXRlZ29yeS0+Z2V0SWQoKSkgeyBpZiAoTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXJfc2V0dGluZ3MvZXhwZW5kX2ZyZW5kbHl1cmwnKSkgeyAkcGFyZW50X2lkcyA9ICRjYXRlZ29yeS0+Z2V0UGFyZW50SWRzKCk7ICRwYXJlbnRfY2F0ZWdvcnkgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9jYXRlZ29yeScpLT5sb2FkKGVuZCgkcGFyZW50X2lkcykpOyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRwYXJlbnRfY2F0ZWdvcnktPmdldERhdGEoJ3VybF9rZXknKSAuICd8JyAuICRjYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpOyB9IGVsc2UgeyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRjYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpOyB9IH0gfSAkbW9kZWwtPmdldFJlcXVlc3QoKS0+c2V0UXVlcnkoJHBhcmFtLCBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKSk7IH0gZWxzZWlmIChpc3NldCgkYXR0clskcGFyYW1dKSAmJiAhaW5fYXJyYXkoJGF0dHJbJHBhcmFtXVsndHlwZSddLCBhcnJheSgncHJpY2UnLCAnZGVjaW1hbCcpKSkgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyBmb3JlYWNoICgkYXR0clskcGFyYW1dWydvcHRpb25zJ10gYXMgJF9rID0+ICRfdikgeyBpZiAoJF92ID09ICRfdmFsdWUpIHsgJHByZXBhcmVfdmFsdWVzW10gPSAkX2s7IGJyZWFrOyB9IH0gfSAkbW9kZWwtPmdldFJlcXVlc3QoKS0+c2V0UXVlcnkoJHBhcmFtLCBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKSk7IH0gZWxzZSB7IGlmICgkYXR0cmlidXRlTW9kZWwtPmdldEZyb250ZW5kSW5wdXQoKSA9PSAkcGFyYW0pIHsgJGF0dHJpYnV0ZSA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL3Jlc291cmNlX2Vhdl9hdHRyaWJ1dGUnKS0+bG9hZCgkYXR0cmlidXRlTW9kZWwtPmdldElkKCkpOyBpZiAoaXNfYXJyYXkoJHZhbHVlKSkgeyBpZiAoaXNzZXQoJHZhbHVlWydmcm9tJ10pKSB7ICRwYXJhbXNbJ19xdWVyeSddWyRhdHRyaWJ1dGUtPmdldEF0dHJpYnV0ZUNvZGUoKSAuICdfZnJvbSddID0gJHZhbHVlWydmcm9tJ107IH0gaWYgKGlzc2V0KCR2YWx1ZVsndG8nXSkpIHsgJHBhcmFtc1snX3F1ZXJ5J11bJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ190byddID0gJHZhbHVlWyd0byddOyB9IH0gZWxzZWlmICgoJGF0dHJpYnV0ZS0+Z2V0UmFuZ2VPcHRpb25zKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6Ok1BTlVBTExZIHx8ICRhdHRyaWJ1dGUtPmdldFJhbmdlT3B0aW9ucygpID09IEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfT3B0aW9uc3JhbmdlOjpBVVRPKSAmJiAkYXR0cmlidXRlLT5nZXRGaWx0ZXJUeXBlKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfTGF5ZXI6OkZJTFRFUl9UWVBFX0RFRkFVTFQgKSB7ICR2YWx1ZXMgPSBleHBsb2RlKCcsJywgJHZhbHVlKTsgJHBhcmFtc1snX3F1ZXJ5J11bJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ19mcm9tJ10gPSAkdmFsdWVzWzBdOyAkcGFyYW1zWydfcXVlcnknXVskYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCkgLiAnX3RvJ10gPSAkdmFsdWVzWzFdOyB1bnNldCgkcGFyYW1zWydfcXVlcnknXVskYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCldKTsgfSBlbHNlIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcHJlcGFyZV92YWx1ZXMgPSBhcnJheSgpOyBmb3JlYWNoICgkdmFsdWVzIGFzICRfdmFsdWUpIHsgZm9yZWFjaCAoJGF0dHJbJHBhcmFtXVsnb3B0aW9ucyddIGFzICRfayA9PiAkX3YpIHsgaWYgKCRfdiA9PSAkX3ZhbHVlKSB7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJF9rOyBicmVhazsgfSB9IH0gaWYgKCFlbXB0eSgkcHJlcGFyZV92YWx1ZXMpKSB7ICRtb2RlbC0+Z2V0UmVxdWVzdCgpLT5zZXRRdWVyeSgkcGFyYW0sIGltcGxvZGUoJywnLCAkcHJlcGFyZV92YWx1ZXMpKTsgfSB9IH0gfSB9IGlmIChpc3NldCgkcGFyYW1zWydfcXVlcnknXSkpIHsgZm9yZWFjaCAoJHBhcmFtc1snX3F1ZXJ5J10gYXMgJHBhcmFtID0+ICR2YWx1ZSkgeyBpZiAoJHZhbHVlKSB7ICRhdHRyaWJ1dGVNb2RlbCA9IE1hZ2U6OmdldE1vZGVsKCdlYXYvZW50aXR5X2F0dHJpYnV0ZScpLT5sb2FkQnlDb2RlKCdjYXRhbG9nX3Byb2R1Y3QnLCAkcGFyYW0pOyBpZiAoJHBhcmFtID09ICdjYXQnKSB7ICR2YWx1ZXMgPSBleHBsb2RlKCcsJywgJHZhbHVlKTsgJHByZXBhcmVfdmFsdWVzID0gYXJyYXkoKTsgZm9yZWFjaCAoJHZhbHVlcyBhcyAkX3ZhbHVlKSB7ICRjYXRlZ29yeSA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL2NhdGVnb3J5JyktPmxvYWQoJF92YWx1ZSk7IGlmICgkY2F0ZWdvcnkgJiYgJGNhdGVnb3J5LT5nZXRJZCgpKSB7IGlmIChNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlcl9zZXR0aW5ncy9leHBlbmRfZnJlbmRseXVybCcpKSB7ICRwYXJlbnRfaWRzID0gJGNhdGVnb3J5LT5nZXRQYXJlbnRJZHMoKTsgJHBhcmVudF9jYXRlZ29yeSA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL2NhdGVnb3J5JyktPmxvYWQoZW5kKCRwYXJlbnRfaWRzKSk7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJHBhcmVudF9jYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpIC4gJ3wnIC4gJGNhdGVnb3J5LT5nZXREYXRhKCd1cmxfa2V5Jyk7IH0gZWxzZSB7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJGNhdGVnb3J5LT5nZXREYXRhKCd1cmxfa2V5Jyk7IH0gfSB9ICRwYXJhbXNbJ19xdWVyeSddWyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSBlbHNlaWYgKGlzc2V0KCRhdHRyWyRwYXJhbV0pICYmICFpbl9hcnJheSgkYXR0clskcGFyYW1dWyd0eXBlJ10sIGFycmF5KCdwcmljZScsICdkZWNpbWFsJykpKSB7ICR2YWx1ZXMgPSBleHBsb2RlKCcsJywgJHZhbHVlKTsgJHByZXBhcmVfdmFsdWVzID0gYXJyYXkoKTsgZm9yZWFjaCAoJHZhbHVlcyBhcyAkX3ZhbHVlKSB7IGZvcmVhY2ggKCRhdHRyWyRwYXJhbV1bJ29wdGlvbnMnXSBhcyAkX2sgPT4gJF92KSB7IGlmICgkX3YgPT0gJF92YWx1ZSkgeyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRfazsgYnJlYWs7IH0gfSB9ICRwYXJhbXNbJ19xdWVyeSddWyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSBlbHNlIHsgaWYgKCRhdHRyaWJ1dGVNb2RlbC0+Z2V0RnJvbnRlbmRJbnB1dCgpID09ICRwYXJhbSkgeyAkYXR0cmlidXRlID0gTWFnZTo6Z2V0TW9kZWwoJ2NhdGFsb2cvcmVzb3VyY2VfZWF2X2F0dHJpYnV0ZScpLT5sb2FkKCRhdHRyaWJ1dGVNb2RlbC0+Z2V0SWQoKSk7IGlmICgoJGF0dHJpYnV0ZS0+Z2V0UmFuZ2VPcHRpb25zKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6Ok1BTlVBTExZIHx8ICRhdHRyaWJ1dGUtPmdldFJhbmdlT3B0aW9ucygpID09IEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfT3B0aW9uc3JhbmdlOjpBVVRPKSAmJiAkYXR0cmlidXRlLT5nZXRGaWx0ZXJUeXBlKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfTGF5ZXI6OkZJTFRFUl9UWVBFX0RFRkFVTFQgKSB7IGlmIChzdHJwb3MoJHZhbHVlLCAnOycpKSB7ICR2YWx1ZXMgPSBleHBsb2RlKCc7JywgJHZhbHVlKTsgfSBlbHNlIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyB9ICRwYXJhbXNbJ19xdWVyeSddWyRhdHRyaWJ1dGUtPmdldEF0dHJpYnV0ZUNvZGUoKSAuICdfZnJvbSddID0gJHZhbHVlc1swXTsgJHBhcmFtc1snX3F1ZXJ5J11bJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ190byddID0gJHZhbHVlc1sxXTsgdW5zZXQoJHBhcmFtc1snX3F1ZXJ5J11bJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpXSk7IH0gZWxzZSB7ICR2YWx1ZXMgPSBleHBsb2RlKCcsJywgJHZhbHVlKTsgJHByZXBhcmVfdmFsdWVzID0gYXJyYXkoKTsgZm9yZWFjaCAoJHZhbHVlcyBhcyAkX3ZhbHVlKSB7IGZvcmVhY2ggKCRhdHRyWyRwYXJhbV1bJ29wdGlvbnMnXSBhcyAkX2sgPT4gJF92KSB7IGlmICgkX3YgPT0gJF92YWx1ZSkgeyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRfazsgYnJlYWs7IH0gfSB9IGlmICghZW1wdHkoJHByZXBhcmVfdmFsdWVzKSkgeyAkcGFyYW1zWydfcXVlcnknXVskcGFyYW1dID0gaW1wbG9kZSgnLCcsICRwcmVwYXJlX3ZhbHVlcyk7IH0gfSB9IH0gfSB9IH0gJHVybCA9ICRtb2RlbC0+Z2V0VXJsKCRyb3V0ZSwgJHBhcmFtcyk7ICRhcnIgPSBwYXJzZV91cmwoJHVybCk7ICRxdWVyeVN0cmluZyA9IGZhbHNlOyBpZiAoaXNzZXQoJGFyclsncXVlcnknXSkpIHsgcGFyc2Vfc3RyKGh0bWxzcGVjaWFsY2hhcnNfZGVjb2RlKCRhcnJbJ3F1ZXJ5J10pLCAkcGFyKTsgaWYgKGlzc2V0KCRwYXJbJ2FqYXgnXSkpIHsgdW5zZXQoJHBhclsnYWpheCddKTsgfSAkcXVlcnlTdHJpbmcgPSBodHRwX2J1aWxkX3F1ZXJ5KCRwYXIpOyB9ICR1cmwgPSAkYXJyWydzY2hlbWUnXSAuICc6Ly8nIC4gJGFyclsnaG9zdCddIC4gJGFyclsncGF0aCddIC4gJz8nOyBpZiAoJHF1ZXJ5U3RyaW5nKSB7ICR1cmwgLj0gJHF1ZXJ5U3RyaW5nOyB9IGZvcmVhY2ggKCRyZXF1ZXN0X3F1ZXJ5IGFzICRwYXJhbSA9PiAkdmFsdWUpIHsgJG1vZGVsLT5nZXRSZXF1ZXN0KCktPnNldFF1ZXJ5KCRwYXJhbSwgJHZhbHVlKTsgfSByZXR1cm4gJHVybDsgfSBwdWJsaWMgZnVuY3Rpb24gZm9ybWF0VXJsVmFsdWUoJHZhbHVlLCAkZGVmYXVsdCkgeyAkb2xkTG9jYWxlID0gc2V0bG9jYWxlKExDX0NPTExBVEUsICIwIik7ICRsb2NhbGVDb2RlID0gTWFnZTo6YXBwKCktPmdldExvY2FsZSgpLT5nZXRMb2NhbGVDb2RlKCk7IHNldGxvY2FsZShMQ19DT0xMQVRFLCAkbG9jYWxlQ29kZSAuICcuVVRGOCcsICdDLlVURi04JywgJ2VuX1VTLnV0ZjgnKTsgJHZhbHVlID0gaWNvbnYobWJfZGV0ZWN0X2VuY29kaW5nKCR2YWx1ZSksICdBU0NJSS8vVFJBTlNMSVQnLCAkdmFsdWUpOyBzZXRsb2NhbGUoTENfQ09MTEFURSwgJG9sZExvY2FsZSk7ICR2YWx1ZSA9IHN0cnRvbG93ZXIoJHZhbHVlKTsgJHZhbHVlID0gcHJlZ19yZXBsYWNlKCcjW14wLTlhLXpdKyNpJywgJy0nLCBNYWdlOjpoZWxwZXIoJ2NhdGFsb2cvcHJvZHVjdF91cmwnKS0+Zm9ybWF0KCR2YWx1ZSkpOyAkdmFsdWUgPSB0cmltKCR2YWx1ZSwgJy0nKTsgcmV0dXJuICR2YWx1ZSA/ICR2YWx1ZSA6ICRkZWZhdWx0OyB9IHB1YmxpYyBmdW5jdGlvbiBpc01vYmlsZURldmljZSgpIHsgJGRldGVjdCA9IG5ldyBNb2JpbGVfRGV0ZWN0KCk7IHJldHVybiAkZGV0ZWN0LT5pc01vYmlsZSgpOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0dvb2dsZWJvdCgpIHsgaWYgKHByZWdfbWF0Y2goIi9Hb29nbGUvIiwgTWFnZTo6aGVscGVyKCdjb3JlL2h0dHAnKS0+Z2V0SHR0cFVzZXJBZ2VudCgpKSB8fCBwcmVnX21hdGNoKCIvYm90LyIsIE1hZ2U6OmhlbHBlcignY29yZS9odHRwJyktPmdldEh0dHBVc2VyQWdlbnQoKSkpIHsgJGlwID0gTWFnZTo6aGVscGVyKCdjb3JlL2h0dHAnKS0+Z2V0UmVtb3RlQWRkcigpOyAkbmFtZSA9IGdldGhvc3RieWFkZHIoJGlwKTsgaWYgKHByZWdfbWF0Y2goIi9Hb29nbGVib3QvIiwgJG5hbWUpIHx8IHByZWdfbWF0Y2goIi9ib3QvIiwgJG5hbWUpKSB7ICRob3N0cyA9IGdldGhvc3RieW5hbWVsKCRuYW1lKTsgZm9yZWFjaCAoJGhvc3RzIGFzICRob3N0KSB7IGlmICgkaG9zdCA9PSAkaXApIHsgcmV0dXJuIHRydWU7IH0gfSB9IH0gZWxzZSB7IHJldHVybiB0cnVlOyB9IHJldHVybiBmYWxzZTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0RmlsdGVySXRlbUNvdW50KCRmaWx0ZXIpIHsgJGNvdW50ID0gMDsgaWYgKCRmaWx0ZXIgJiYgJGZpbHRlci0+Z2V0SXRlbXMoKSkgeyBmb3JlYWNoICgkZmlsdGVyLT5nZXRJdGVtcygpIGFzICRpdGVtKSB7ICRjb3VudCArPSAkaXRlbS0+Z2V0Q291bnQoKTsgfSB9IGlmICgkY291bnQgPT0gMCAmJiAkZmlsdGVyLT5nZXRGaWx0ZXIoKS0+Z2V0UmVxdWVzdFZhclZhbHVlKCkgPT0gJ3N0b2NrX3N0YXR1cycpIHsgcmV0dXJuIDE7IH0gcmV0dXJuICRjb3VudDsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0RmlsdGVyKCkgeyAkZmlsdGVyID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9maWx0ZXJfYnRuX3R4dCcpOyBpZiAoJGZpbHRlciA9PSAnJykgeyAkZmlsdGVyID0gJHRoaXMtPl9fKCdGaWx0ZXInKTsgfSByZXR1cm4gJGZpbHRlcjsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0Q2xlYXJBbGwoKSB7ICRjbGVhciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvY2xlYXJfYnRuX3R4dCcpOyBpZiAoJGNsZWFyID09ICcnKSB7ICRjbGVhciA9ICR0aGlzLT5fXygnQ2xlYXIgQWxsJyk7IH0gcmV0dXJuICRjbGVhcjsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0TW9yZSgpIHsgJG1vcmUgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyL21vcmVfYnRuX3R4dCcpOyBpZiAoJG1vcmUgPT0gJycpIHsgJG1vcmUgPSAkdGhpcy0+X18oJ01vcmUnKTsgfSByZXR1cm4gJG1vcmU7IH0gcHVibGljIGZ1bmN0aW9uIGdldExlc3MoKSB7ICRsZXNzID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9sZXNzX2J0bl90eHQnKTsgaWYgKCRsZXNzID09ICcnKSB7ICRsZXNzID0gJHRoaXMtPl9fKCdMZXNzJyk7IH0gcmV0dXJuICRsZXNzOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRTaG93bW9yZSgpIHsgJHNob3dtb3JlID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9zaG93bW9yZV9idG5fdHh0Jyk7IGlmICgkc2hvd21vcmUgPT0gJycpIHsgJHNob3dtb3JlID0gJHRoaXMtPl9fKCdTaG93IG1vcmUgcHJvZHVjdHMnKTsgfSByZXR1cm4gJHNob3dtb3JlOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRCYWNrdG90b3AoKSB7ICRiYWNrdG90b3AgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyL2JhY2t0b3RvcF9idG5fdHh0Jyk7IGlmICgkYmFja3RvdG9wID09ICcnKSB7ICRiYWNrdG90b3AgPSAkdGhpcy0+X18oJ0JhY2sgdG8gVG9wJyk7IH0gcmV0dXJuICRiYWNrdG90b3A7IH0gcHVibGljIGZ1bmN0aW9uIGlzRW50ZXJwcmlzZSgpIHsgaWYgKE1hZ2U6OmdldENvbmZpZygpLT5nZXRNb2R1bGVDb25maWcoJ0VudGVycHJpc2VfRW50ZXJwcmlzZScpICYmIE1hZ2U6OmdldENvbmZpZygpLT5nZXRNb2R1bGVDb25maWcoJ0VudGVycHJpc2VfQWRtaW5Hd3MnKSAmJiBNYWdlOjpnZXRDb25maWcoKS0+Z2V0TW9kdWxlQ29uZmlnKCdFbnRlcnByaXNlX0NoZWNrb3V0JykgJiYgTWFnZTo6Z2V0Q29uZmlnKCktPmdldE1vZHVsZUNvbmZpZygnRW50ZXJwcmlzZV9DdXN0b21lcicpKSB7IHJldHVybiB0cnVlOyB9IHJldHVybiBmYWxzZTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0U2lkZSgkdHlwZSkgeyBzd2l0Y2ggKCR0eXBlKSB7IGNhc2UgR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9BdHRyaWJ1dGVsb2NhdGlvbjo6TEVGVF9CTE9DSzogcmV0dXJuICdsZWZ0JzsgYnJlYWs7IGNhc2UgR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9BdHRyaWJ1dGVsb2NhdGlvbjo6Q09OVEVOVDogcmV0dXJuICdjb250ZW50JzsgYnJlYWs7IGNhc2UgR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9BdHRyaWJ1dGVsb2NhdGlvbjo6UklHSFRfQkxPQ0s6IHJldHVybiAncmlnaHQnOyBicmVhazsgZGVmYXVsdDogcmV0dXJuICdsZWZ0JzsgYnJlYWs7IH0gfSBwdWJsaWMgZnVuY3Rpb24gZ2V0Q2xlYXJMaW5rVXJsKCRfZmlsdGVyKSB7IGlmICgkX2ZpbHRlci0+Z2V0RmlsdGVyKCktPmdldFJlcXVlc3RWYXIoKSAhPSAnY2F0JyAmJiAkX2ZpbHRlci0+Z2V0RmlsdGVyKCktPmdldFJlcXVlc3RWYXIoKSAhPSAnc3RvY2tfc3RhdHVzJykgeyBpZiAoJF9maWx0ZXItPmdldEZpbHRlcigpLT5nZXRBdHRyaWJ1dGVNb2RlbCgpLT5nZXRGcm9udGVuZElucHV0KCkpIHsgJGF0dHJpYnV0ZSA9ICRfZmlsdGVyLT5nZXRGaWx0ZXIoKS0+Z2V0QXR0cmlidXRlTW9kZWwoKTsgaWYgKChpbl9hcnJheSgkYXR0cmlidXRlLT5nZXRGaWx0ZXJUeXBlKCksIGFycmF5KEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0xheWVyOjpGSUxURVJfVFlQRV9TTElERVIsIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0xheWVyOjpGSUxURVJfVFlQRV9TTElERVJfSU5QVVQsIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0xheWVyOjpGSUxURVJfVFlQRV9JTlBVVF9TTElERVIpICkgJiYgIU1hZ2U6OmhlbHBlcignZ29tYWdlX25hdmlnYXRpb24nKS0+aXNNb2JpbGVEZXZpY2UoKSkgfHwgKCRhdHRyaWJ1dGUtPmdldEZpbHRlclR5cGUoKSA9PSBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9MYXllcjo6RklMVEVSX1RZUEVfREVGQVVMVCAmJiAkYXR0cmlidXRlLT5nZXRSYW5nZU9wdGlvbnMoKSAhPSBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9BZG1pbmh0bWxfU3lzdGVtX0NvbmZpZ19Tb3VyY2VfRmlsdGVyX09wdGlvbnNyYW5nZTo6Tk8pICkgeyAkcGFyYW1zID0gYXJyYXkoKTsgJHBhcmFtc1snX25vc2lkJ10gPSB0cnVlOyAkcGFyYW1zWydfY3VycmVudCddID0gdHJ1ZTsgJHBhcmFtc1snX3VzZV9yZXdyaXRlJ10gPSB0cnVlOyAkcGFyYW1zWydfZXNjYXBlJ10gPSBmYWxzZTsgJHVybCA9ICR0aGlzLT5nZXRGaWx0ZXJVcmwoJyovKi8qJywgJHBhcmFtcyk7ICRjbGVhbl91cmwgPSAkdGhpcy0+Z2V0RmlsdGVyVXJsKCcqLyovKicsIGFycmF5KCdfY3VycmVudCcgPT4gdHJ1ZSwgJ19ub3NpZCcgPT4gdHJ1ZSwgJ191c2VfcmV3cml0ZScgPT4gdHJ1ZSwgJ19xdWVyeScgPT4gYXJyYXkoKSwgJ19lc2NhcGUnID0+IGZhbHNlKSk7IGlmIChzdHJwb3MoJGNsZWFuX3VybCwgIj8iKSAhPT0gZmFsc2UpIHsgJGNsZWFuX3VybCA9IHN1YnN0cigkY2xlYW5fdXJsLCAwLCBzdHJwb3MoJGNsZWFuX3VybCwgJz8nKSk7IH0gJHBhcmFtcyA9IHN0cl9yZXBsYWNlKCRjbGVhbl91cmwsICIiLCAkdXJsKTsgJHBhcmFtcyA9IHN0cl9yZXBsYWNlKCI/IiwgIiIsICRwYXJhbXMpOyAkcGFyQXJyYXkgPSBleHBsb2RlKCImIiwgJHBhcmFtcyk7ICRuZXdQYXJBcnJheSA9IGFycmF5KCk7IGZvcmVhY2ggKCRwYXJBcnJheSBhcyAkcGFyKSB7ICRleHBhciA9IGV4cGxvZGUoIj0iLCAkcGFyKTsgaWYgKCRleHBhclswXSAhPSAkYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCkgLiAnX2Zyb20nICYmICRleHBhclswXSAhPSAkYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCkgLiAnX3RvJyApIHsgJG5ld1BhckFycmF5W10gPSAkcGFyOyB9IH0gaWYgKCRuZXdQYXJBcnJheSkgeyBpZiAoJF9maWx0ZXItPmdldEFqYXhFbmFibGVkKCkpIHsgcmV0dXJuICRjbGVhbl91cmwgLiAnPycgLiBpbXBsb2RlKCImIiwgJG5ld1BhckFycmF5KSAuICcmYWpheD0xJzsgfSBlbHNlIHsgcmV0dXJuICRjbGVhbl91cmwgLiAnPycgLiBpbXBsb2RlKCImIiwgJG5ld1BhckFycmF5KTsgfSB9IGVsc2UgeyBpZiAoJF9maWx0ZXItPmdldEFqYXhFbmFibGVkKCkpIHsgcmV0dXJuICRjbGVhbl91cmwgLiAnP2FqYXg9MSc7IH0gZWxzZSB7IHJldHVybiAkY2xlYW5fdXJsOyB9IH0gfSB9IGVsc2UgeyByZXR1cm4gJF9maWx0ZXItPmdldENsZWFyTGlua1VybCgpOyB9IH0gZWxzZSB7IHJldHVybiAkX2ZpbHRlci0+Z2V0Q2xlYXJMaW5rVXJsKCk7IH0gfSBwdWJsaWMgZnVuY3Rpb24gbm90aWZ5KCkgeyAkZnJlcXVlbmN5ID0gaW50dmFsKE1hZ2U6OmFwcCgpLT5sb2FkQ2FjaGUoJ2dvbWFnZV9ub3RpZmljYXRpb25zX2ZyZXF1ZW5jeScpKTsgaWYgKCEkZnJlcXVlbmN5KSB7ICRmcmVxdWVuY3kgPSAyNDsgfSAkbGFzdF91cGRhdGUgPSBpbnR2YWwoTWFnZTo6YXBwKCktPmxvYWRDYWNoZSgnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKSk7IGlmICgoJGZyZXF1ZW5jeSAqIDYwICogNjAgKyAkbGFzdF91cGRhdGUpID4gdGltZSgpKSB7IHJldHVybiBmYWxzZTsgfSAkdGltZXN0YW1wID0gJGxhc3RfdXBkYXRlOyBpZiAoISR0aW1lc3RhbXApIHsgJHRpbWVzdGFtcCA9IHRpbWUoKTsgfSB0cnkgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX25vdGlmaWNhdGlvbi9pbmRleC9kYXRhJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgdHJ1ZSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAnc2t1PWFkdmFuY2VkLW5hdmlnYXRpb24mdGltZXN0YW1wPScgLiAkdGltZXN0YW1wIC4gJyZ2ZXI9JyAuIHVybGVuY29kZSgnNC4zJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMzApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIDApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWUhPU1QsIDApOyAkY29udGVudCA9IGN1cmxfZXhlYygkY2gpOyAkcmVzdWx0ID0gWmVuZF9Kc29uOjpkZWNvZGUoJGNvbnRlbnQpOyBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydmcmVxdWVuY3knXSkgJiYgKCRyZXN1bHRbJ2ZyZXF1ZW5jeSddICE9ICRmcmVxdWVuY3kpKSB7IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUoJHJlc3VsdFsnZnJlcXVlbmN5J10sICdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKTsgfSBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydkYXRhJ10pKSB7IGlmICghZW1wdHkoJHJlc3VsdFsnZGF0YSddKSkgeyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5ub3RpZmljYXRpb24vaW5ib3gnKS0+cGFyc2UoJHJlc3VsdFsnZGF0YSddKTsgfSB9IH0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgeyB9IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUodGltZSgpLCAnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0SXNBbnltb3JlVmVyc2lvbigkbWFqb3IsICRtaW5vciwgJHJldmlzaW9uID0gMCkgeyAkdmVyc2lvbl9pbmZvID0gTWFnZTo6Z2V0VmVyc2lvbigpOyAkdmVyc2lvbl9pbmZvID0gZXhwbG9kZSgnLicsICR2ZXJzaW9uX2luZm8pOyBpZiAoJHZlcnNpb25faW5mb1swXSA+ICRtYWpvcikgeyByZXR1cm4gdHJ1ZTsgfSBlbHNlaWYgKCR2ZXJzaW9uX2luZm9bMF0gPT0gJG1ham9yKSB7IGlmICgkdmVyc2lvbl9pbmZvWzFdID4gJG1pbm9yKSB7IHJldHVybiB0cnVlOyB9IGVsc2VpZiAoJHZlcnNpb25faW5mb1sxXSA9PSAkbWlub3IpIHsgaWYgKCR2ZXJzaW9uX2luZm9bMl0gPj0gJHJldmlzaW9uKSB7IHJldHVybiB0cnVlOyB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0gfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9IH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfSB9IH0="));