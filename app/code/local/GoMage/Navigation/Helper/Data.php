<?php eval(base64_decode("LyoqICogR29NYWdlIEFkdmFuY2VkIE5hdmlnYXRpb24gRXh0ZW5zaW9uICogKiBAY2F0ZWdvcnkgRXh0ZW5zaW9uICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTAtMjAxNiBHb01hZ2UgKGh0dHBzOi8vd3d3LmdvbWFnZS5jb20pICogQGF1dGhvciBHb01hZ2UgKiBAbGljZW5zZSBodHRwczovL3d3dy5nb21hZ2UuY29tL2xpY2Vuc2UtYWdyZWVtZW50LyBTaW5nbGUgZG9tYWluIGxpY2Vuc2UgKiBAdGVybXMgb2YgdXNlIGh0dHBzOi8vd3d3LmdvbWFnZS5jb20vdGVybXMtb2YtdXNlICogQHZlcnNpb24gUmVsZWFzZTogNC45LjIgKiBAc2luY2UgQ2xhc3MgYXZhaWxhYmxlIHNpbmNlIFJlbGVhc2UgMS4wICovIHJlcXVpcmVfb25jZShNYWdlOjpnZXRCYXNlRGlyKCdsaWInKSAuIERTIC4gJ0dvTWFnZScgLiBEUyAuICdNb2JpbGVEZXRlY3QnIC4gRFMgLiAnTmF2aWdhdGlvbl9Nb2JpbGVfRGV0ZWN0LnBocCcpOyBjbGFzcyBHb01hZ2VfTmF2aWdhdGlvbl9IZWxwZXJfRGF0YSBleHRlbmRzIE1hZ2VfQ29yZV9IZWxwZXJfQWJzdHJhY3QgeyBwcm90ZWN0ZWQgJHByb2R1Y3RfYXR0cmlidXRlcyA9IGFycmF5KCk7IHB1YmxpYyBmdW5jdGlvbiBnZXRDb25maWdEYXRhKCRub2RlKSB7IHJldHVybiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vJyAuICRub2RlKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QWxsU3RvcmVEb21haW5zKCkgeyAkZG9tYWlucyA9IGFycmF5KCk7IGZvcmVhY2ggKE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlcygpIGFzICR3ZWJzaXRlKSB7ICR1cmwgPSAkd2Vic2l0ZS0+Z2V0Q29uZmlnKCd3ZWIvdW5zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gJHVybCA9ICR3ZWJzaXRlLT5nZXRDb25maWcoJ3dlYi9zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gfSByZXR1cm4gYXJyYXlfdW5pcXVlKCRkb21haW5zKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhYmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX3coKSB7IGlmICghTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi9pbnN0YWxsZWQnKSB8fCAoaW50dmFsKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vY291bnQnKSkgPiAxMCkgKSB7IHJldHVybiBhcnJheSgpOyB9ICR0aW1lX3RvX3VwZGF0ZSA9IDYwICogNjAgKiAyNCAqIDE1OyAkciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKTsgJHQgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3RpbWUnKTsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3dlYnNpdGVzJyk7ICRsYXN0X2NoZWNrID0gc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkdCkpOyAkYWxsc2l0ZXMgPSBleHBsb2RlKCcsJywgc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkcykpKTsgJGFsbHNpdGVzID0gYXJyYXlfZGlmZigkYWxsc2l0ZXMsIGFycmF5KCIiKSk7IGlmICgoJGxhc3RfY2hlY2sgKyAkdGltZV90b191cGRhdGUpIDwgdGltZSgpKSB7ICR0aGlzLT5hKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24va2V5JyksIGludHZhbChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2NvdW50JykpLCBpbXBsb2RlKCcsJywgJGFsbHNpdGVzKSApOyB9IHJldHVybiAkYWxsc2l0ZXM7IH0gcHVibGljIGZ1bmN0aW9uIGEoJGssICRjID0gMCwgJHMgPSAnJykgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX2Rvd25sb2FkYWJsZS9rZXkvY2hlY2snKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICdrZXk9JyAuIHVybGVuY29kZSgkaykgLiAnJnNrdT1hZHZhbmNlZC1uYXZpZ2F0aW9uJmRvbWFpbnM9JyAuIHVybGVuY29kZShpbXBsb2RlKCcsJywgJHRoaXMtPmdldEFsbFN0b3JlRG9tYWlucygpKSkgLiAnJnZlcj0nIC4gdXJsZW5jb2RlKCc0LjkuMicpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDMwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllIT1NULCAwKTsgJGNvbnRlbnQgPSBjdXJsX2V4ZWMoJGNoKTsgJHIgPSBaZW5kX0pzb246OmRlY29kZSgkY29udGVudCk7ICRlID0gTWFnZTo6aGVscGVyKCdjb3JlJyk7IGlmIChlbXB0eSgkcikpIHsgJHZhbHVlMSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKTsgJGdyb3VwcyA9IGFycmF5KCAnYWR2YW5jZWRuYXZpZ2F0aW9uJyA9PiBhcnJheSggJ2ZpZWxkcycgPT4gYXJyYXkoICdhcicgPT4gYXJyYXkoICd2YWx1ZScgPT4gJHZhbHVlMSApLCAnd2Vic2l0ZXMnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi93ZWJzaXRlcycpICksICd0aW1lJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKSRlLT5lbmNyeXB0KCR2YWx1ZTEgLiAodGltZSgpIC0gKDYwICogNjAgKiAyNCAqIDE1IC0gMTgwMCkpIC4gJHZhbHVlMSkgKSwgJ2NvdW50JyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAkYyArIDEpICkgKSApOyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykgLT5zZXRTZWN0aW9uKCdnb21hZ2VfYWN0aXZhdGlvbicpIC0+c2V0R3JvdXBzKCRncm91cHMpIC0+c2F2ZSgpOyBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7IE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgcmV0dXJuOyB9ICR2YWx1ZTEgPSAnJzsgJHZhbHVlMiA9ICcnOyBpZiAoaXNzZXQoJHJbJ2QnXSkgJiYgaXNzZXQoJHJbJ2MnXSkpIHsgJHZhbHVlMSA9ICRlLT5lbmNyeXB0KGJhc2U2NF9lbmNvZGUoWmVuZF9Kc29uOjplbmNvZGUoJHIpKSk7IGlmICghJHMpIHsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3dlYnNpdGVzJyk7IH0gJHMgPSBhcnJheV9zbGljZShleHBsb2RlKCcsJywgJHMpLCAwLCAkclsnYyddKTsgJHZhbHVlMiA9ICRlLT5lbmNyeXB0KCR2YWx1ZTEgLiBpbXBsb2RlKCcsJywgJHMpIC4gJHZhbHVlMSk7IH0gJGdyb3VwcyA9IGFycmF5KCAnYWR2YW5jZWRuYXZpZ2F0aW9uJyA9PiBhcnJheSggJ2ZpZWxkcycgPT4gYXJyYXkoICdhcicgPT4gYXJyYXkoICd2YWx1ZScgPT4gJHZhbHVlMSApLCAnd2Vic2l0ZXMnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpJHZhbHVlMiApLCAndGltZScgPT4gYXJyYXkoICd2YWx1ZScgPT4gKHN0cmluZykkZS0+ZW5jcnlwdCgkdmFsdWUxIC4gdGltZSgpIC4gJHZhbHVlMSkgKSwgJ2luc3RhbGxlZCcgPT4gYXJyYXkoICd2YWx1ZScgPT4gMSApLCAnY291bnQnID0+IGFycmF5KCAndmFsdWUnID0+IDApICkgKSApOyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykgLT5zZXRTZWN0aW9uKCdnb21hZ2VfYWN0aXZhdGlvbicpIC0+c2V0R3JvdXBzKCRncm91cHMpIC0+c2F2ZSgpOyBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7IE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgfSAvKiogKiBAcmV0dXJuIGFycmF5ICovIHB1YmxpYyBmdW5jdGlvbiBnYSgpIHsgJGdhUmVzdWx0ID0gW107ICRkZWNyeXB0ZWQgPSBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2FyJykpOyAkZGVjb2RlZEJhc2U2NCA9IGJhc2U2NF9kZWNvZGUoJGRlY3J5cHRlZCk7IGlmICgkZGVjb2RlZEJhc2U2NCkgeyAkZ2FSZXN1bHQgPSBaZW5kX0pzb246OmRlY29kZSgkZGVjb2RlZEJhc2U2NCk7IH0gcmV0dXJuICRnYVJlc3VsdDsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uKCkgeyBpZiAoJHRoaXMtPmlzTW9iaWxlRGV2aWNlKCkgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9nZW5lcmFsL2Rpc2FibGVfbW9iaWxlJykpIHsgcmV0dXJuIGZhbHNlOyB9IHJldHVybiBpbl9hcnJheShNYWdlOjphcHAoKS0+Z2V0U3RvcmUoKS0+Z2V0V2Vic2l0ZUlkKCksICR0aGlzLT5nZXRBdmFpbGF2ZWxXZWJzaXRlcygpKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2dlbmVyYWwvbW9kZScpOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0dvbWFnZU5hdmlnYXRpb25NZW51KCkgeyByZXR1cm4gaW5fYXJyYXkoTWFnZTo6YXBwKCktPmdldFN0b3JlKCktPmdldFdlYnNpdGVJZCgpLCAkdGhpcy0+Z2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSkgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9tZW51YmFyc2V0dGluZ3MvbmF2aWdhdGlvbicpOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0dvbWFnZU5hdmlnYXRpb25BamF4KCkgeyByZXR1cm4gJHRoaXMtPmlzR29tYWdlTmF2aWdhdGlvbigpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZ2VuZXJhbC9wYWdlcicpICYmIChNYWdlOjpyZWdpc3RyeSgnY3VycmVudF9jYXRlZ29yeScpIHx8IChNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Um91dGVOYW1lKCkgPT0gJ2NhdGFsb2dzZWFyY2gnICYmIE1hZ2U6OmFwcCgpLT5nZXRGcm9udENvbnRyb2xsZXIoKS0+Z2V0UmVxdWVzdCgpLT5nZXRDb250cm9sbGVyTmFtZSgpICE9ICdhZHZhbmNlZCcpKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uQ2xlYXJBamF4KCkgeyByZXR1cm4gJHRoaXMtPmlzR29tYWdlTmF2aWdhdGlvbigpICYmIChNYWdlOjpyZWdpc3RyeSgnY3VycmVudF9jYXRlZ29yeScpIHx8IChNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Um91dGVOYW1lKCkgPT0gJ2NhdGFsb2dzZWFyY2gnICYmIE1hZ2U6OmFwcCgpLT5nZXRGcm9udENvbnRyb2xsZXIoKS0+Z2V0UmVxdWVzdCgpLT5nZXRDb250cm9sbGVyTmFtZSgpICE9ICdhZHZhbmNlZCcpKTsgfSBwdWJsaWMgZnVuY3Rpb24gZm9ybWF0Q29sb3IoJHZhbHVlKSB7IGlmICgkdmFsdWUgPSBwcmVnX3JlcGxhY2UoJy9bXmEtekEtWjAtOVxzXS8nLCAnJywgJHZhbHVlKSkgeyAkdmFsdWUgPSAnIycgLiAkdmFsdWU7IH0gcmV0dXJuICR2YWx1ZTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNGcmVuZGx5VXJsKCkgeyByZXR1cm4gJHRoaXMtPmlzR29tYWdlTmF2aWdhdGlvbigpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyX3NldHRpbmdzL2ZyZW5kbHl1cmwnKSAmJiAhJHRoaXMtPmlzR29NYWdlU2VvQm9vc3RlckVuYWJsZWQoKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb01hZ2VTZW9Cb29zdGVyRW5hYmxlZCgpIHsgJF9tb2R1bGVzID0gTWFnZTo6Z2V0Q29uZmlnKCktPmdldE5vZGUoJ21vZHVsZXMnKS0+Y2hpbGRyZW4oKTsgJF9tb2R1bGVzQXJyYXkgPSAoYXJyYXkpJF9tb2R1bGVzOyBpZiAoIWlzc2V0KCRfbW9kdWxlc0FycmF5WydHb01hZ2VfU2VvQm9vc3RlciddKSkgeyByZXR1cm4gZmFsc2U7IH0gcmV0dXJuICRfbW9kdWxlc0FycmF5WydHb01hZ2VfU2VvQm9vc3RlciddLT5pcygnYWN0aXZlJyk7IH0gcHVibGljIGZ1bmN0aW9uIGdldFJlcXVlc3QoKSB7ICRyZXF1ZXN0ID0gTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCk7IGlmICgkdGhpcy0+aXNHb01hZ2VTZW9Cb29zdGVyRW5hYmxlZCgpKSB7ICRoZWxwZXIgPSBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9zZW9ib29zdGVyL2xheWVyZWQnKTsgJHJlcXVlc3QgPSAkaGVscGVyLT5nZXRTZXBhcmF0b3IoKSB8fCAkaGVscGVyLT5jYW5BZGRSZXdyaXRlUGF0aCgpID8gJGhlbHBlci0+Z2V0UmVxdWVzdCgpIDogJHJlcXVlc3Q7IH0gcmV0dXJuICRyZXF1ZXN0OyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRGaWx0ZXJVcmwoJHJvdXRlID0gJyovKi8qJywgJHBhcmFtcyA9IGFycmF5KCkpIHsgaWYgKCEkdGhpcy0+aXNGcmVuZGx5VXJsKCkpIHsgJHBhcmFtc1snX3F1ZXJ5J11bJ2FqYXgnXSA9IG51bGw7IHJldHVybiBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9uYXZpZ2F0aW9uL3VybCcpLT53cmFwcChNYWdlOjpnZXRVcmwoJHJvdXRlLCAkcGFyYW1zKSk7IH0gJG1vZGVsID0gTWFnZTo6Z2V0TW9kZWwoJ2NvcmUvdXJsJyk7ICRhdHRyID0gTWFnZTo6cmVnaXN0cnkoJ2dhbl9maWx0ZXJfYXR0cmlidXRlcycpOyAkcXVlcnlfcGFyYW1zID0gaXNfYXJyYXkoJG1vZGVsLT5nZXRSZXF1ZXN0KCktPmdldFF1ZXJ5KCkpID8gJG1vZGVsLT5nZXRSZXF1ZXN0KCktPmdldFF1ZXJ5KCkgOiBhcnJheSgpOyAkcXVlcnkgPSBhcnJheSgpOyBpZiAoaXNzZXQoJHBhcmFtc1snX3F1ZXJ5J10pICYmIGlzX2FycmF5KCRwYXJhbXNbJ19xdWVyeSddKSkgeyAkcXVlcnlfcGFyYW1zID0gYXJyYXlfbWVyZ2UoJHF1ZXJ5X3BhcmFtcywgJHBhcmFtc1snX3F1ZXJ5J10pOyB9IGZvcmVhY2ggKCRxdWVyeV9wYXJhbXMgYXMgJHBhcmFtID0+ICR2YWx1ZSkgeyBpZiAoaXNfbnVsbCgkdmFsdWUpKSB7ICRxdWVyeVskcGFyYW1dID0gbnVsbDsgY29udGludWU7IH0gaWYgKCRwYXJhbSA9PSAnY2F0JykgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyAkY2F0ZWdvcnkgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9jYXRlZ29yeScpLT5sb2FkKCRfdmFsdWUpOyBpZiAoJGNhdGVnb3J5ICYmICRjYXRlZ29yeS0+Z2V0SWQoKSkgeyBpZiAoTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXJfc2V0dGluZ3MvZXhwZW5kX2ZyZW5kbHl1cmwnKSkgeyAkcGFyZW50X2lkcyA9ICRjYXRlZ29yeS0+Z2V0UGFyZW50SWRzKCk7ICRwYXJlbnRfY2F0ZWdvcnkgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9jYXRlZ29yeScpLT5sb2FkKGVuZCgkcGFyZW50X2lkcykpOyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRwYXJlbnRfY2F0ZWdvcnktPmdldERhdGEoJ3VybF9rZXknKSAuICd8JyAuICRjYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpOyB9IGVsc2UgeyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRjYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpOyB9IH0gfSBpZiAoIWVtcHR5KCRwcmVwYXJlX3ZhbHVlcykpIHsgJHF1ZXJ5WyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSBlbHNlIHsgJHF1ZXJ5WyRwYXJhbV0gPSBudWxsOyB9IH0gZWxzZWlmIChpc3NldCgkYXR0clskcGFyYW1dKSAmJiAhaW5fYXJyYXkoJGF0dHJbJHBhcmFtXVsndHlwZSddLCBhcnJheSgncHJpY2UnLCAnZGVjaW1hbCcpKSkgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyBmb3JlYWNoICgkYXR0clskcGFyYW1dWydvcHRpb25zJ10gYXMgJF9rID0+ICRfdikgeyBpZiAoJF92ID09ICRfdmFsdWUpIHsgJHByZXBhcmVfdmFsdWVzW10gPSAkX2s7IGJyZWFrOyB9IH0gfSBpZiAoIWVtcHR5KCRwcmVwYXJlX3ZhbHVlcykpIHsgJHF1ZXJ5WyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSBlbHNlIHsgJHF1ZXJ5WyRwYXJhbV0gPSBudWxsOyB9IH0gZWxzZWlmIChpc3NldCgkYXR0clskcGFyYW1dKSAmJiBpbl9hcnJheSgkYXR0clskcGFyYW1dWyd0eXBlJ10sIGFycmF5KCdwcmljZScsICdkZWNpbWFsJykpKSB7IGlmIChpc19hcnJheSgkdmFsdWUpKSB7IGlmIChpc3NldCgkdmFsdWVbJ2Zyb20nXSkpIHsgJHF1ZXJ5WyRwYXJhbSAuICdfZnJvbSddID0gJHZhbHVlWydmcm9tJ107IH0gaWYgKGlzc2V0KCR2YWx1ZVsndG8nXSkpIHsgJHF1ZXJ5WyRwYXJhbSAuICdfdG8nXSA9ICR2YWx1ZVsndG8nXTsgfSB9IGVsc2VpZiAoKCRhdHRyaWJ1dGUgPSAkdGhpcy0+Z2V0UHJvZHVjdEF0dHJpYnV0ZSgkcGFyYW0pKSAmJiBpbl9hcnJheSgkYXR0cmlidXRlLT5nZXRSYW5nZU9wdGlvbnMoKSwgYXJyYXkoR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6Ok1BTlVBTExZLCBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9BZG1pbmh0bWxfU3lzdGVtX0NvbmZpZ19Tb3VyY2VfRmlsdGVyX09wdGlvbnNyYW5nZTo6QVVUTykgKSAmJiAkYXR0cmlidXRlLT5nZXRGaWx0ZXJUeXBlKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQ2F0YWxvZ19MYXllcjo6RklMVEVSX1RZUEVfREVGQVVMVCApIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcXVlcnlbJHBhcmFtIC4gJ19mcm9tJ10gPSAkdmFsdWVzWzBdOyAkcXVlcnlbJHBhcmFtIC4gJ190byddID0gJHZhbHVlc1sxXTsgJHF1ZXJ5WyRwYXJhbV0gPSBudWxsOyB9IGVsc2UgeyAkcXVlcnlbJHBhcmFtXSA9ICR2YWx1ZTsgfSB9IGVsc2UgeyAkcXVlcnlbJHBhcmFtXSA9ICR2YWx1ZTsgfSB9ICRwYXJhbXNbJ19xdWVyeSddID0gJHF1ZXJ5OyAkcGFyYW1zWydfcXVlcnknXVsnYWpheCddID0gbnVsbDsgJHBhcmFtc1snX3NlY3VyZSddID0gTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCktPmlzU2VjdXJlKCk7IHJldHVybiBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9uYXZpZ2F0aW9uL3VybCcpLT53cmFwcCgkbW9kZWwtPmdldFVybCgkcm91dGUsICRwYXJhbXMpKTsgfSBwdWJsaWMgZnVuY3Rpb24gZm9ybWF0VXJsVmFsdWUoJHZhbHVlLCAkZGVmYXVsdCkgeyAkb2xkTG9jYWxlID0gc2V0bG9jYWxlKExDX0NPTExBVEUsICIwIik7ICRsb2NhbGVDb2RlID0gTWFnZTo6YXBwKCktPmdldExvY2FsZSgpLT5nZXRMb2NhbGVDb2RlKCk7IHNldGxvY2FsZShMQ19DT0xMQVRFLCAkbG9jYWxlQ29kZSAuICcuVVRGOCcsICdDLlVURi04JywgJ2VuX1VTLnV0ZjgnKTsgJHZhbHVlID0gaWNvbnYobWJfZGV0ZWN0X2VuY29kaW5nKCR2YWx1ZSksICdBU0NJSS8vVFJBTlNMSVQnLCAkdmFsdWUpOyBzZXRsb2NhbGUoTENfQ09MTEFURSwgJG9sZExvY2FsZSk7ICR2YWx1ZSA9IHN0cnRvbG93ZXIoJHZhbHVlKTsgJHZhbHVlID0gcHJlZ19yZXBsYWNlKCcjW14wLTlhLXpdKyNpJywgJy0nLCBNYWdlOjpoZWxwZXIoJ2NhdGFsb2cvcHJvZHVjdF91cmwnKS0+Zm9ybWF0KCR2YWx1ZSkpOyAkdmFsdWUgPSB0cmltKCR2YWx1ZSwgJy0nKTsgcmV0dXJuICR2YWx1ZSA/ICR2YWx1ZSA6ICRkZWZhdWx0OyB9IHB1YmxpYyBmdW5jdGlvbiBpc01vYmlsZURldmljZSgpIHsgJGRldGVjdCA9IG5ldyBOYXZpZ2F0aW9uX01vYmlsZV9EZXRlY3QoKTsgcmV0dXJuICRkZXRlY3QtPmlzTW9iaWxlKCk7IH0gcHVibGljIGZ1bmN0aW9uIGdldEZpbHRlckl0ZW1Db3VudCgkZmlsdGVyKSB7ICRjb3VudCA9IDA7IGlmICgkZmlsdGVyICYmICRmaWx0ZXItPmdldEl0ZW1zKCkpIHsgZm9yZWFjaCAoJGZpbHRlci0+Z2V0SXRlbXMoKSBhcyAkaXRlbSkgeyAkY291bnQgKz0gJGl0ZW0tPmdldENvdW50KCk7IH0gfSBpZiAoJGNvdW50ID09IDAgJiYgJGZpbHRlci0+Z2V0RmlsdGVyKCktPmdldFJlcXVlc3RWYXJWYWx1ZSgpID09ICdzdG9ja19zdGF0dXMnKSB7IHJldHVybiAxOyB9IHJldHVybiAkY291bnQ7IH0gcHVibGljIGZ1bmN0aW9uIGdldEZpbHRlcigpIHsgJGZpbHRlciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvZmlsdGVyX2J0bl90eHQnKTsgaWYgKCRmaWx0ZXIgPT0gJycpIHsgJGZpbHRlciA9ICR0aGlzLT5fXygnRmlsdGVyJyk7IH0gcmV0dXJuICRmaWx0ZXI7IH0gcHVibGljIGZ1bmN0aW9uIGdldENsZWFyQWxsKCkgeyAkY2xlYXIgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyL2NsZWFyX2J0bl90eHQnKTsgaWYgKCRjbGVhciA9PSAnJykgeyAkY2xlYXIgPSAkdGhpcy0+X18oJ0NsZWFyIEFsbCcpOyB9IHJldHVybiAkY2xlYXI7IH0gcHVibGljIGZ1bmN0aW9uIGdldE1vcmUoKSB7ICRtb3JlID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9tb3JlX2J0bl90eHQnKTsgaWYgKCRtb3JlID09ICcnKSB7ICRtb3JlID0gJHRoaXMtPl9fKCdNb3JlJyk7IH0gcmV0dXJuICRtb3JlOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRMZXNzKCkgeyAkbGVzcyA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvbGVzc19idG5fdHh0Jyk7IGlmICgkbGVzcyA9PSAnJykgeyAkbGVzcyA9ICR0aGlzLT5fXygnTGVzcycpOyB9IHJldHVybiAkbGVzczsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0U2hvd21vcmUoKSB7ICRzaG93bW9yZSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvc2hvd21vcmVfYnRuX3R4dCcpOyBpZiAoJHNob3dtb3JlID09ICcnKSB7ICRzaG93bW9yZSA9ICR0aGlzLT5fXygnU2hvdyBtb3JlIHByb2R1Y3RzJyk7IH0gcmV0dXJuICRzaG93bW9yZTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QmFja3RvdG9wKCkgeyAkYmFja3RvdG9wID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9iYWNrdG90b3BfYnRuX3R4dCcpOyBpZiAoJGJhY2t0b3RvcCA9PSAnJykgeyAkYmFja3RvdG9wID0gJHRoaXMtPl9fKCdCYWNrIHRvIFRvcCcpOyB9IHJldHVybiAkYmFja3RvdG9wOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0VudGVycHJpc2UoKSB7IGlmIChNYWdlOjpnZXRDb25maWcoKS0+Z2V0TW9kdWxlQ29uZmlnKCdFbnRlcnByaXNlX0VudGVycHJpc2UnKSAmJiBNYWdlOjpnZXRDb25maWcoKS0+Z2V0TW9kdWxlQ29uZmlnKCdFbnRlcnByaXNlX0FkbWluR3dzJykgJiYgTWFnZTo6Z2V0Q29uZmlnKCktPmdldE1vZHVsZUNvbmZpZygnRW50ZXJwcmlzZV9DaGVja291dCcpICYmIE1hZ2U6OmdldENvbmZpZygpLT5nZXRNb2R1bGVDb25maWcoJ0VudGVycHJpc2VfQ3VzdG9tZXInKSkgeyByZXR1cm4gdHJ1ZTsgfSByZXR1cm4gZmFsc2U7IH0gcHVibGljIGZ1bmN0aW9uIGdldFNpZGUoJHR5cGUpIHsgc3dpdGNoICgkdHlwZSkgeyBjYXNlIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfQXR0cmlidXRlbG9jYXRpb246OkxFRlRfQkxPQ0s6IHJldHVybiAnbGVmdCc7IGJyZWFrOyBjYXNlIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfQXR0cmlidXRlbG9jYXRpb246OkNPTlRFTlQ6IHJldHVybiAnY29udGVudCc7IGJyZWFrOyBjYXNlIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfQXR0cmlidXRlbG9jYXRpb246OlJJR0hUX0JMT0NLOiByZXR1cm4gJ3JpZ2h0JzsgYnJlYWs7IGRlZmF1bHQ6IHJldHVybiAnbGVmdCc7IGJyZWFrOyB9IH0gcHVibGljIGZ1bmN0aW9uIG5vdGlmeSgpIHsgJGZyZXF1ZW5jeSA9IGludHZhbChNYWdlOjphcHAoKS0+bG9hZENhY2hlKCdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKSk7IGlmICghJGZyZXF1ZW5jeSkgeyAkZnJlcXVlbmN5ID0gMjQ7IH0gJGxhc3RfdXBkYXRlID0gaW50dmFsKE1hZ2U6OmFwcCgpLT5sb2FkQ2FjaGUoJ2dvbWFnZV9ub3RpZmljYXRpb25zX2xhc3RfdXBkYXRlJykpOyBpZiAoKCRmcmVxdWVuY3kgKiA2MCAqIDYwICsgJGxhc3RfdXBkYXRlKSA+IHRpbWUoKSkgeyByZXR1cm4gZmFsc2U7IH0gJHRpbWVzdGFtcCA9ICRsYXN0X3VwZGF0ZTsgaWYgKCEkdGltZXN0YW1wKSB7ICR0aW1lc3RhbXAgPSB0aW1lKCk7IH0gdHJ5IHsgJGNoID0gY3VybF9pbml0KCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsIHNwcmludGYoJ2h0dHBzOi8vd3d3LmdvbWFnZS5jb20vaW5kZXgucGhwL2dvbWFnZV9ub3RpZmljYXRpb24vaW5kZXgvZGF0YScpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVEZJRUxEUywgJ3NrdT1hZHZhbmNlZC1uYXZpZ2F0aW9uJnRpbWVzdGFtcD0nIC4gJHRpbWVzdGFtcCAuICcmdmVyPScgLiB1cmxlbmNvZGUoJzQuOS4xJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMzApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIDApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWUhPU1QsIDApOyAkY29udGVudCA9IGN1cmxfZXhlYygkY2gpOyAkcmVzdWx0ID0gWmVuZF9Kc29uOjpkZWNvZGUoJGNvbnRlbnQpOyBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydmcmVxdWVuY3knXSkgJiYgKCRyZXN1bHRbJ2ZyZXF1ZW5jeSddICE9ICRmcmVxdWVuY3kpKSB7IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUoJHJlc3VsdFsnZnJlcXVlbmN5J10sICdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKTsgfSBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydkYXRhJ10pKSB7IGlmICghZW1wdHkoJHJlc3VsdFsnZGF0YSddKSkgeyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5ub3RpZmljYXRpb24vaW5ib3gnKS0+cGFyc2UoJHJlc3VsdFsnZGF0YSddKTsgfSB9IH0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgeyB9IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUodGltZSgpLCAnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0SXNBbnltb3JlVmVyc2lvbigkbWFqb3IsICRtaW5vciwgJHJldmlzaW9uID0gMCkgeyAkdmVyc2lvbl9pbmZvID0gTWFnZTo6Z2V0VmVyc2lvbigpOyAkdmVyc2lvbl9pbmZvID0gZXhwbG9kZSgnLicsICR2ZXJzaW9uX2luZm8pOyBpZiAoJHZlcnNpb25faW5mb1swXSA+ICRtYWpvcikgeyByZXR1cm4gdHJ1ZTsgfSBlbHNlaWYgKCR2ZXJzaW9uX2luZm9bMF0gPT0gJG1ham9yKSB7IGlmICgkdmVyc2lvbl9pbmZvWzFdID4gJG1pbm9yKSB7IHJldHVybiB0cnVlOyB9IGVsc2VpZiAoJHZlcnNpb25faW5mb1sxXSA9PSAkbWlub3IpIHsgaWYgKCR2ZXJzaW9uX2luZm9bMl0gPj0gJHJldmlzaW9uKSB7IHJldHVybiB0cnVlOyB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0gfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9IH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfSB9IHB1YmxpYyBmdW5jdGlvbiBnZXRQcm9kdWN0QXR0cmlidXRlKCRjb2RlKSB7IGlmICghaXNzZXQoJHRoaXMtPnByb2R1Y3RfYXR0cmlidXRlc1skY29kZV0pKSB7ICRhdHRyaWJ1dGVNb2RlbCA9IE1hZ2U6OmdldE1vZGVsKCdlYXYvZW50aXR5X2F0dHJpYnV0ZScpLT5sb2FkQnlDb2RlKCdjYXRhbG9nX3Byb2R1Y3QnLCAkY29kZSk7ICRhdHRyaWJ1dGUgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9yZXNvdXJjZV9lYXZfYXR0cmlidXRlJyktPmxvYWQoJGF0dHJpYnV0ZU1vZGVsLT5nZXRJZCgpKTsgJHRoaXMtPnByb2R1Y3RfYXR0cmlidXRlc1skY29kZV0gPSAkYXR0cmlidXRlOyB9IHJldHVybiAkdGhpcy0+cHJvZHVjdF9hdHRyaWJ1dGVzWyRjb2RlXTsgfSB9"));