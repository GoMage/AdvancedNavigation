<?php eval(base64_decode("LyoqICogR29NYWdlIEFkdmFuY2VkIE5hdmlnYXRpb24gRXh0ZW5zaW9uICogKiBAY2F0ZWdvcnkgRXh0ZW5zaW9uICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTAtMjAxNSBHb01hZ2UgKGh0dHA6Ly93d3cuZ29tYWdlLmNvbSkgKiBAYXV0aG9yIEdvTWFnZSAqIEBsaWNlbnNlIGh0dHA6Ly93d3cuZ29tYWdlLmNvbS9saWNlbnNlLWFncmVlbWVudC8gU2luZ2xlIGRvbWFpbiBsaWNlbnNlICogQHRlcm1zIG9mIHVzZSBodHRwOi8vd3d3LmdvbWFnZS5jb20vdGVybXMtb2YtdXNlICogQHZlcnNpb24gUmVsZWFzZTogNC45LjEgKiBAc2luY2UgQ2xhc3MgYXZhaWxhYmxlIHNpbmNlIFJlbGVhc2UgMS4wICovIHJlcXVpcmVfb25jZShNYWdlOjpnZXRCYXNlRGlyKCdsaWInKSAuIERTIC4gJ0dvTWFnZScgLiBEUyAuICdNb2JpbGVEZXRlY3QnIC4gRFMgLiAnTmF2aWdhdGlvbl9Nb2JpbGVfRGV0ZWN0LnBocCcpOyBjbGFzcyBHb01hZ2VfTmF2aWdhdGlvbl9IZWxwZXJfRGF0YSBleHRlbmRzIE1hZ2VfQ29yZV9IZWxwZXJfQWJzdHJhY3QgeyBwcm90ZWN0ZWQgJHByb2R1Y3RfYXR0cmlidXRlcyA9IGFycmF5KCk7IHB1YmxpYyBmdW5jdGlvbiBnZXRDb25maWdEYXRhKCRub2RlKSB7IHJldHVybiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vJyAuICRub2RlKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QWxsU3RvcmVEb21haW5zKCkgeyAkZG9tYWlucyA9IGFycmF5KCk7IGZvcmVhY2ggKE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlcygpIGFzICR3ZWJzaXRlKSB7ICR1cmwgPSAkd2Vic2l0ZS0+Z2V0Q29uZmlnKCd3ZWIvdW5zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gJHVybCA9ICR3ZWJzaXRlLT5nZXRDb25maWcoJ3dlYi9zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gfSByZXR1cm4gYXJyYXlfdW5pcXVlKCRkb21haW5zKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhYmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX3coKSB7IGlmICghTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi9pbnN0YWxsZWQnKSB8fCAoaW50dmFsKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vY291bnQnKSkgPiAxMCkgKSB7IHJldHVybiBhcnJheSgpOyB9ICR0aW1lX3RvX3VwZGF0ZSA9IDYwICogNjAgKiAyNCAqIDE1OyAkciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKTsgJHQgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3RpbWUnKTsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3dlYnNpdGVzJyk7ICRsYXN0X2NoZWNrID0gc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkdCkpOyAkYWxsc2l0ZXMgPSBleHBsb2RlKCcsJywgc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkcykpKTsgJGFsbHNpdGVzID0gYXJyYXlfZGlmZigkYWxsc2l0ZXMsIGFycmF5KCIiKSk7IGlmICgoJGxhc3RfY2hlY2sgKyAkdGltZV90b191cGRhdGUpIDwgdGltZSgpKSB7ICR0aGlzLT5hKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24va2V5JyksIGludHZhbChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2NvdW50JykpLCBpbXBsb2RlKCcsJywgJGFsbHNpdGVzKSApOyB9IHJldHVybiAkYWxsc2l0ZXM7IH0gcHVibGljIGZ1bmN0aW9uIGEoJGssICRjID0gMCwgJHMgPSAnJykgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX2Rvd25sb2FkYWJsZS9rZXkvY2hlY2snKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICdrZXk9JyAuIHVybGVuY29kZSgkaykgLiAnJnNrdT1hZHZhbmNlZC1uYXZpZ2F0aW9uJmRvbWFpbnM9JyAuIHVybGVuY29kZShpbXBsb2RlKCcsJywgJHRoaXMtPmdldEFsbFN0b3JlRG9tYWlucygpKSkgLiAnJnZlcj0nIC4gdXJsZW5jb2RlKCc0LjkuMScpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDMwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllIT1NULCAwKTsgJGNvbnRlbnQgPSBjdXJsX2V4ZWMoJGNoKTsgJHIgPSBaZW5kX0pzb246OmRlY29kZSgkY29udGVudCk7ICRlID0gTWFnZTo6aGVscGVyKCdjb3JlJyk7IGlmIChlbXB0eSgkcikpIHsgJHZhbHVlMSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKTsgJGdyb3VwcyA9IGFycmF5KCAnYWR2YW5jZWRuYXZpZ2F0aW9uJyA9PiBhcnJheSggJ2ZpZWxkcycgPT4gYXJyYXkoICdhcicgPT4gYXJyYXkoICd2YWx1ZScgPT4gJHZhbHVlMSApLCAnd2Vic2l0ZXMnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi93ZWJzaXRlcycpICksICd0aW1lJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKSRlLT5lbmNyeXB0KCR2YWx1ZTEgLiAodGltZSgpIC0gKDYwICogNjAgKiAyNCAqIDE1IC0gMTgwMCkpIC4gJHZhbHVlMSkgKSwgJ2NvdW50JyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAkYyArIDEpICkgKSApOyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykgLT5zZXRTZWN0aW9uKCdnb21hZ2VfYWN0aXZhdGlvbicpIC0+c2V0R3JvdXBzKCRncm91cHMpIC0+c2F2ZSgpOyBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7IE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgcmV0dXJuOyB9ICR2YWx1ZTEgPSAnJzsgJHZhbHVlMiA9ICcnOyBpZiAoaXNzZXQoJHJbJ2QnXSkgJiYgaXNzZXQoJHJbJ2MnXSkpIHsgJHZhbHVlMSA9ICRlLT5lbmNyeXB0KGJhc2U2NF9lbmNvZGUoWmVuZF9Kc29uOjplbmNvZGUoJHIpKSk7IGlmICghJHMpIHsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3dlYnNpdGVzJyk7IH0gJHMgPSBhcnJheV9zbGljZShleHBsb2RlKCcsJywgJHMpLCAwLCAkclsnYyddKTsgJHZhbHVlMiA9ICRlLT5lbmNyeXB0KCR2YWx1ZTEgLiBpbXBsb2RlKCcsJywgJHMpIC4gJHZhbHVlMSk7IH0gJGdyb3VwcyA9IGFycmF5KCAnYWR2YW5jZWRuYXZpZ2F0aW9uJyA9PiBhcnJheSggJ2ZpZWxkcycgPT4gYXJyYXkoICdhcicgPT4gYXJyYXkoICd2YWx1ZScgPT4gJHZhbHVlMSApLCAnd2Vic2l0ZXMnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpJHZhbHVlMiApLCAndGltZScgPT4gYXJyYXkoICd2YWx1ZScgPT4gKHN0cmluZykkZS0+ZW5jcnlwdCgkdmFsdWUxIC4gdGltZSgpIC4gJHZhbHVlMSkgKSwgJ2luc3RhbGxlZCcgPT4gYXJyYXkoICd2YWx1ZScgPT4gMSApLCAnY291bnQnID0+IGFycmF5KCAndmFsdWUnID0+IDApICkgKSApOyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykgLT5zZXRTZWN0aW9uKCdnb21hZ2VfYWN0aXZhdGlvbicpIC0+c2V0R3JvdXBzKCRncm91cHMpIC0+c2F2ZSgpOyBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7IE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2EoKSB7IHJldHVybiBaZW5kX0pzb246OmRlY29kZShiYXNlNjRfZGVjb2RlKE1hZ2U6OmhlbHBlcignY29yZScpLT5kZWNyeXB0KE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKSkpKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uKCkgeyBpZiAoJHRoaXMtPmlzTW9iaWxlRGV2aWNlKCkgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9nZW5lcmFsL2Rpc2FibGVfbW9iaWxlJykpIHsgcmV0dXJuIGZhbHNlOyB9IHJldHVybiBpbl9hcnJheShNYWdlOjphcHAoKS0+Z2V0U3RvcmUoKS0+Z2V0V2Vic2l0ZUlkKCksICR0aGlzLT5nZXRBdmFpbGF2ZWxXZWJzaXRlcygpKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2dlbmVyYWwvbW9kZScpOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0dvbWFnZU5hdmlnYXRpb25NZW51KCkgeyByZXR1cm4gaW5fYXJyYXkoTWFnZTo6YXBwKCktPmdldFN0b3JlKCktPmdldFdlYnNpdGVJZCgpLCAkdGhpcy0+Z2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSkgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9tZW51YmFyc2V0dGluZ3MvbmF2aWdhdGlvbicpOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0dvbWFnZU5hdmlnYXRpb25BamF4KCkgeyByZXR1cm4gJHRoaXMtPmlzR29tYWdlTmF2aWdhdGlvbigpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZ2VuZXJhbC9wYWdlcicpICYmIChNYWdlOjpyZWdpc3RyeSgnY3VycmVudF9jYXRlZ29yeScpIHx8IChNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Um91dGVOYW1lKCkgPT0gJ2NhdGFsb2dzZWFyY2gnICYmIE1hZ2U6OmFwcCgpLT5nZXRGcm9udENvbnRyb2xsZXIoKS0+Z2V0UmVxdWVzdCgpLT5nZXRDb250cm9sbGVyTmFtZSgpICE9ICdhZHZhbmNlZCcpKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uQ2xlYXJBamF4KCkgeyByZXR1cm4gJHRoaXMtPmlzR29tYWdlTmF2aWdhdGlvbigpICYmIChNYWdlOjpyZWdpc3RyeSgnY3VycmVudF9jYXRlZ29yeScpIHx8IChNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Um91dGVOYW1lKCkgPT0gJ2NhdGFsb2dzZWFyY2gnICYmIE1hZ2U6OmFwcCgpLT5nZXRGcm9udENvbnRyb2xsZXIoKS0+Z2V0UmVxdWVzdCgpLT5nZXRDb250cm9sbGVyTmFtZSgpICE9ICdhZHZhbmNlZCcpKTsgfSBwdWJsaWMgZnVuY3Rpb24gZm9ybWF0Q29sb3IoJHZhbHVlKSB7IGlmICgkdmFsdWUgPSBwcmVnX3JlcGxhY2UoJy9bXmEtekEtWjAtOVxzXS8nLCAnJywgJHZhbHVlKSkgeyAkdmFsdWUgPSAnIycgLiAkdmFsdWU7IH0gcmV0dXJuICR2YWx1ZTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNGcmVuZGx5VXJsKCkgeyByZXR1cm4gJHRoaXMtPmlzR29tYWdlTmF2aWdhdGlvbigpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyX3NldHRpbmdzL2ZyZW5kbHl1cmwnKSAmJiAhJHRoaXMtPmlzR29NYWdlU2VvQm9vc3RlckVuYWJsZWQoKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb01hZ2VTZW9Cb29zdGVyRW5hYmxlZCgpIHsgJF9tb2R1bGVzID0gTWFnZTo6Z2V0Q29uZmlnKCktPmdldE5vZGUoJ21vZHVsZXMnKS0+Y2hpbGRyZW4oKTsgJF9tb2R1bGVzQXJyYXkgPSAoYXJyYXkpJF9tb2R1bGVzOyBpZiAoIWlzc2V0KCRfbW9kdWxlc0FycmF5WydHb01hZ2VfU2VvQm9vc3RlciddKSkgeyByZXR1cm4gZmFsc2U7IH0gcmV0dXJuICRfbW9kdWxlc0FycmF5WydHb01hZ2VfU2VvQm9vc3RlciddLT5pcygnYWN0aXZlJyk7IH0gcHVibGljIGZ1bmN0aW9uIGdldFJlcXVlc3QoKSB7ICRyZXF1ZXN0ID0gTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCk7IGlmICgkdGhpcy0+aXNHb01hZ2VTZW9Cb29zdGVyRW5hYmxlZCgpKSB7ICRoZWxwZXIgPSBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9zZW9ib29zdGVyL2xheWVyZWQnKTsgJHJlcXVlc3QgPSAkaGVscGVyLT5nZXRTZXBhcmF0b3IoKSB8fCAkaGVscGVyLT5jYW5BZGRSZXdyaXRlUGF0aCgpID8gJGhlbHBlci0+Z2V0UmVxdWVzdCgpIDogJHJlcXVlc3Q7IH0gcmV0dXJuICRyZXF1ZXN0OyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRGaWx0ZXJVcmwoJHJvdXRlID0gJyovKi8qJywgJHBhcmFtcyA9IGFycmF5KCkpIHsgaWYgKCEkdGhpcy0+aXNGcmVuZGx5VXJsKCkpIHsgJHBhcmFtc1snX3F1ZXJ5J11bJ2FqYXgnXSA9IG51bGw7IHJldHVybiBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9uYXZpZ2F0aW9uL3VybCcpLT53cmFwcChNYWdlOjpnZXRVcmwoJHJvdXRlLCAkcGFyYW1zKSk7IH0gJG1vZGVsID0gTWFnZTo6Z2V0TW9kZWwoJ2NvcmUvdXJsJyk7ICRhdHRyID0gTWFnZTo6cmVnaXN0cnkoJ2dhbl9maWx0ZXJfYXR0cmlidXRlcycpOyAkcXVlcnlfcGFyYW1zID0gaXNfYXJyYXkoJG1vZGVsLT5nZXRSZXF1ZXN0KCktPmdldFF1ZXJ5KCkpID8gJG1vZGVsLT5nZXRSZXF1ZXN0KCktPmdldFF1ZXJ5KCkgOiBhcnJheSgpOyAkcXVlcnkgPSBhcnJheSgpOyBpZiAoaXNzZXQoJHBhcmFtc1snX3F1ZXJ5J10pICYmIGlzX2FycmF5KCRwYXJhbXNbJ19xdWVyeSddKSkgeyAkcXVlcnlfcGFyYW1zID0gYXJyYXlfbWVyZ2UoJHF1ZXJ5X3BhcmFtcywgJHBhcmFtc1snX3F1ZXJ5J10pOyB9IGZvcmVhY2ggKCRxdWVyeV9wYXJhbXMgYXMgJHBhcmFtID0+ICR2YWx1ZSkgeyBpZiAoaXNfbnVsbCgkdmFsdWUpKSB7ICRxdWVyeVskcGFyYW1dID0gbnVsbDsgY29udGludWU7IH0gaWYgKCRwYXJhbSA9PSAnY2F0JykgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyAkY2F0ZWdvcnkgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9jYXRlZ29yeScpLT5sb2FkKCRfdmFsdWUpOyBpZiAoJGNhdGVnb3J5ICYmICRjYXRlZ29yeS0+Z2V0SWQoKSkgeyBpZiAoTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXJfc2V0dGluZ3MvZXhwZW5kX2ZyZW5kbHl1cmwnKSkgeyAkcGFyZW50X2lkcyA9ICRjYXRlZ29yeS0+Z2V0UGFyZW50SWRzKCk7ICRwYXJlbnRfY2F0ZWdvcnkgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9jYXRlZ29yeScpLT5sb2FkKGVuZCgkcGFyZW50X2lkcykpOyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRwYXJlbnRfY2F0ZWdvcnktPmdldERhdGEoJ3VybF9rZXknKSAuICd8JyAuICRjYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpOyB9IGVsc2UgeyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRjYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpOyB9IH0gfSBpZiAoIWVtcHR5KCRwcmVwYXJlX3ZhbHVlcykpIHsgJHF1ZXJ5WyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSBlbHNlIHsgJHF1ZXJ5WyRwYXJhbV0gPSBudWxsOyB9IH0gZWxzZWlmIChpc3NldCgkYXR0clskcGFyYW1dKSAmJiAhaW5fYXJyYXkoJGF0dHJbJHBhcmFtXVsndHlwZSddLCBhcnJheSgncHJpY2UnLCAnZGVjaW1hbCcpKSkgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyBmb3JlYWNoICgkYXR0clskcGFyYW1dWydvcHRpb25zJ10gYXMgJF9rID0+ICRfdikgeyBpZiAoJF92ID09ICRfdmFsdWUpIHsgJHByZXBhcmVfdmFsdWVzW10gPSAkX2s7IGJyZWFrOyB9IH0gfSBpZiAoIWVtcHR5KCRwcmVwYXJlX3ZhbHVlcykpIHsgJHF1ZXJ5WyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSBlbHNlIHsgJHF1ZXJ5WyRwYXJhbV0gPSBudWxsOyB9IH0gZWxzZWlmIChpc3NldCgkYXR0clskcGFyYW1dKSAmJiBpbl9hcnJheSgkYXR0clskcGFyYW1dWyd0eXBlJ10sIGFycmF5KCdwcmljZScsICdkZWNpbWFsJykpKSB7IGlmIChpc19hcnJheSgkdmFsdWUpKSB7IGlmIChpc3NldCgkdmFsdWVbJ2Zyb20nXSkpIHsgJHF1ZXJ5WyRwYXJhbSAuICdfZnJvbSddID0gJHZhbHVlWydmcm9tJ107IH0gaWYgKGlzc2V0KCR2YWx1ZVsndG8nXSkpIHsgJHF1ZXJ5WyRwYXJhbSAuICdfdG8nXSA9ICR2YWx1ZVsndG8nXTsgfSB9IGVsc2VpZiAoKCRhdHRyaWJ1dGUgPSAkdGhpcy0+Z2V0UHJvZHVjdEF0dHJpYnV0ZSgkcGFyYW0pKSAmJiBpbl9hcnJheSgkYXR0cmlidXRlLT5nZXRSYW5nZU9wdGlvbnMoKSwgYXJyYXkoR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6Ok1BTlVBTExZLCBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9BZG1pbmh0bWxfU3lzdGVtX0NvbmZpZ19Tb3VyY2VfRmlsdGVyX09wdGlvbnNyYW5nZTo6QVVUTykgKSAmJiAkYXR0cmlidXRlLT5nZXRGaWx0ZXJUeXBlKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQ2F0YWxvZ19MYXllcjo6RklMVEVSX1RZUEVfREVGQVVMVCApIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcXVlcnlbJHBhcmFtIC4gJ19mcm9tJ10gPSAkdmFsdWVzWzBdOyAkcXVlcnlbJHBhcmFtIC4gJ190byddID0gJHZhbHVlc1sxXTsgJHF1ZXJ5WyRwYXJhbV0gPSBudWxsOyB9IGVsc2UgeyAkcXVlcnlbJHBhcmFtXSA9ICR2YWx1ZTsgfSB9IGVsc2UgeyAkcXVlcnlbJHBhcmFtXSA9ICR2YWx1ZTsgfSB9ICRwYXJhbXNbJ19xdWVyeSddID0gJHF1ZXJ5OyAkcGFyYW1zWydfcXVlcnknXVsnYWpheCddID0gbnVsbDsgcmV0dXJuIE1hZ2U6OmhlbHBlcignZ29tYWdlX25hdmlnYXRpb24vdXJsJyktPndyYXBwKCRtb2RlbC0+Z2V0VXJsKCRyb3V0ZSwgJHBhcmFtcykpOyB9IHB1YmxpYyBmdW5jdGlvbiBmb3JtYXRVcmxWYWx1ZSgkdmFsdWUsICRkZWZhdWx0KSB7ICRvbGRMb2NhbGUgPSBzZXRsb2NhbGUoTENfQ09MTEFURSwgIjAiKTsgJGxvY2FsZUNvZGUgPSBNYWdlOjphcHAoKS0+Z2V0TG9jYWxlKCktPmdldExvY2FsZUNvZGUoKTsgc2V0bG9jYWxlKExDX0NPTExBVEUsICRsb2NhbGVDb2RlIC4gJy5VVEY4JywgJ0MuVVRGLTgnLCAnZW5fVVMudXRmOCcpOyAkdmFsdWUgPSBpY29udihtYl9kZXRlY3RfZW5jb2RpbmcoJHZhbHVlKSwgJ0FTQ0lJLy9UUkFOU0xJVCcsICR2YWx1ZSk7IHNldGxvY2FsZShMQ19DT0xMQVRFLCAkb2xkTG9jYWxlKTsgJHZhbHVlID0gc3RydG9sb3dlcigkdmFsdWUpOyAkdmFsdWUgPSBwcmVnX3JlcGxhY2UoJyNbXjAtOWEtel0rI2knLCAnLScsIE1hZ2U6OmhlbHBlcignY2F0YWxvZy9wcm9kdWN0X3VybCcpLT5mb3JtYXQoJHZhbHVlKSk7ICR2YWx1ZSA9IHRyaW0oJHZhbHVlLCAnLScpOyByZXR1cm4gJHZhbHVlID8gJHZhbHVlIDogJGRlZmF1bHQ7IH0gcHVibGljIGZ1bmN0aW9uIGlzTW9iaWxlRGV2aWNlKCkgeyAkZGV0ZWN0ID0gbmV3IE5hdmlnYXRpb25fTW9iaWxlX0RldGVjdCgpOyByZXR1cm4gJGRldGVjdC0+aXNNb2JpbGUoKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0RmlsdGVySXRlbUNvdW50KCRmaWx0ZXIpIHsgJGNvdW50ID0gMDsgaWYgKCRmaWx0ZXIgJiYgJGZpbHRlci0+Z2V0SXRlbXMoKSkgeyBmb3JlYWNoICgkZmlsdGVyLT5nZXRJdGVtcygpIGFzICRpdGVtKSB7ICRjb3VudCArPSAkaXRlbS0+Z2V0Q291bnQoKTsgfSB9IGlmICgkY291bnQgPT0gMCAmJiAkZmlsdGVyLT5nZXRGaWx0ZXIoKS0+Z2V0UmVxdWVzdFZhclZhbHVlKCkgPT0gJ3N0b2NrX3N0YXR1cycpIHsgcmV0dXJuIDE7IH0gcmV0dXJuICRjb3VudDsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0RmlsdGVyKCkgeyAkZmlsdGVyID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9maWx0ZXJfYnRuX3R4dCcpOyBpZiAoJGZpbHRlciA9PSAnJykgeyAkZmlsdGVyID0gJHRoaXMtPl9fKCdGaWx0ZXInKTsgfSByZXR1cm4gJGZpbHRlcjsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0Q2xlYXJBbGwoKSB7ICRjbGVhciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvY2xlYXJfYnRuX3R4dCcpOyBpZiAoJGNsZWFyID09ICcnKSB7ICRjbGVhciA9ICR0aGlzLT5fXygnQ2xlYXIgQWxsJyk7IH0gcmV0dXJuICRjbGVhcjsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0TW9yZSgpIHsgJG1vcmUgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyL21vcmVfYnRuX3R4dCcpOyBpZiAoJG1vcmUgPT0gJycpIHsgJG1vcmUgPSAkdGhpcy0+X18oJ01vcmUnKTsgfSByZXR1cm4gJG1vcmU7IH0gcHVibGljIGZ1bmN0aW9uIGdldExlc3MoKSB7ICRsZXNzID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9sZXNzX2J0bl90eHQnKTsgaWYgKCRsZXNzID09ICcnKSB7ICRsZXNzID0gJHRoaXMtPl9fKCdMZXNzJyk7IH0gcmV0dXJuICRsZXNzOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRTaG93bW9yZSgpIHsgJHNob3dtb3JlID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9zaG93bW9yZV9idG5fdHh0Jyk7IGlmICgkc2hvd21vcmUgPT0gJycpIHsgJHNob3dtb3JlID0gJHRoaXMtPl9fKCdTaG93IG1vcmUgcHJvZHVjdHMnKTsgfSByZXR1cm4gJHNob3dtb3JlOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRCYWNrdG90b3AoKSB7ICRiYWNrdG90b3AgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyL2JhY2t0b3RvcF9idG5fdHh0Jyk7IGlmICgkYmFja3RvdG9wID09ICcnKSB7ICRiYWNrdG90b3AgPSAkdGhpcy0+X18oJ0JhY2sgdG8gVG9wJyk7IH0gcmV0dXJuICRiYWNrdG90b3A7IH0gcHVibGljIGZ1bmN0aW9uIGlzRW50ZXJwcmlzZSgpIHsgaWYgKE1hZ2U6OmdldENvbmZpZygpLT5nZXRNb2R1bGVDb25maWcoJ0VudGVycHJpc2VfRW50ZXJwcmlzZScpICYmIE1hZ2U6OmdldENvbmZpZygpLT5nZXRNb2R1bGVDb25maWcoJ0VudGVycHJpc2VfQWRtaW5Hd3MnKSAmJiBNYWdlOjpnZXRDb25maWcoKS0+Z2V0TW9kdWxlQ29uZmlnKCdFbnRlcnByaXNlX0NoZWNrb3V0JykgJiYgTWFnZTo6Z2V0Q29uZmlnKCktPmdldE1vZHVsZUNvbmZpZygnRW50ZXJwcmlzZV9DdXN0b21lcicpKSB7IHJldHVybiB0cnVlOyB9IHJldHVybiBmYWxzZTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0U2lkZSgkdHlwZSkgeyBzd2l0Y2ggKCR0eXBlKSB7IGNhc2UgR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9BdHRyaWJ1dGVsb2NhdGlvbjo6TEVGVF9CTE9DSzogcmV0dXJuICdsZWZ0JzsgYnJlYWs7IGNhc2UgR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9BdHRyaWJ1dGVsb2NhdGlvbjo6Q09OVEVOVDogcmV0dXJuICdjb250ZW50JzsgYnJlYWs7IGNhc2UgR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9BdHRyaWJ1dGVsb2NhdGlvbjo6UklHSFRfQkxPQ0s6IHJldHVybiAncmlnaHQnOyBicmVhazsgZGVmYXVsdDogcmV0dXJuICdsZWZ0JzsgYnJlYWs7IH0gfSBwdWJsaWMgZnVuY3Rpb24gbm90aWZ5KCkgeyAkZnJlcXVlbmN5ID0gaW50dmFsKE1hZ2U6OmFwcCgpLT5sb2FkQ2FjaGUoJ2dvbWFnZV9ub3RpZmljYXRpb25zX2ZyZXF1ZW5jeScpKTsgaWYgKCEkZnJlcXVlbmN5KSB7ICRmcmVxdWVuY3kgPSAyNDsgfSAkbGFzdF91cGRhdGUgPSBpbnR2YWwoTWFnZTo6YXBwKCktPmxvYWRDYWNoZSgnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKSk7IGlmICgoJGZyZXF1ZW5jeSAqIDYwICogNjAgKyAkbGFzdF91cGRhdGUpID4gdGltZSgpKSB7IHJldHVybiBmYWxzZTsgfSAkdGltZXN0YW1wID0gJGxhc3RfdXBkYXRlOyBpZiAoISR0aW1lc3RhbXApIHsgJHRpbWVzdGFtcCA9IHRpbWUoKTsgfSB0cnkgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX25vdGlmaWNhdGlvbi9pbmRleC9kYXRhJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVCwgdHJ1ZSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NURklFTERTLCAnc2t1PWFkdmFuY2VkLW5hdmlnYXRpb24mdGltZXN0YW1wPScgLiAkdGltZXN0YW1wIC4gJyZ2ZXI9JyAuIHVybGVuY29kZSgnNC45LjEnKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAzMCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgMCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZSE9TVCwgMCk7ICRjb250ZW50ID0gY3VybF9leGVjKCRjaCk7ICRyZXN1bHQgPSBaZW5kX0pzb246OmRlY29kZSgkY29udGVudCk7IGlmICgkcmVzdWx0ICYmIGlzc2V0KCRyZXN1bHRbJ2ZyZXF1ZW5jeSddKSAmJiAoJHJlc3VsdFsnZnJlcXVlbmN5J10gIT0gJGZyZXF1ZW5jeSkpIHsgTWFnZTo6YXBwKCktPnNhdmVDYWNoZSgkcmVzdWx0WydmcmVxdWVuY3knXSwgJ2dvbWFnZV9ub3RpZmljYXRpb25zX2ZyZXF1ZW5jeScpOyB9IGlmICgkcmVzdWx0ICYmIGlzc2V0KCRyZXN1bHRbJ2RhdGEnXSkpIHsgaWYgKCFlbXB0eSgkcmVzdWx0WydkYXRhJ10pKSB7IE1hZ2U6OmdldE1vZGVsKCdhZG1pbm5vdGlmaWNhdGlvbi9pbmJveCcpLT5wYXJzZSgkcmVzdWx0WydkYXRhJ10pOyB9IH0gfSBjYXRjaCAoRXhjZXB0aW9uICRlKSB7IH0gTWFnZTo6YXBwKCktPnNhdmVDYWNoZSh0aW1lKCksICdnb21hZ2Vfbm90aWZpY2F0aW9uc19sYXN0X3VwZGF0ZScpOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRJc0FueW1vcmVWZXJzaW9uKCRtYWpvciwgJG1pbm9yLCAkcmV2aXNpb24gPSAwKSB7ICR2ZXJzaW9uX2luZm8gPSBNYWdlOjpnZXRWZXJzaW9uKCk7ICR2ZXJzaW9uX2luZm8gPSBleHBsb2RlKCcuJywgJHZlcnNpb25faW5mbyk7IGlmICgkdmVyc2lvbl9pbmZvWzBdID4gJG1ham9yKSB7IHJldHVybiB0cnVlOyB9IGVsc2VpZiAoJHZlcnNpb25faW5mb1swXSA9PSAkbWFqb3IpIHsgaWYgKCR2ZXJzaW9uX2luZm9bMV0gPiAkbWlub3IpIHsgcmV0dXJuIHRydWU7IH0gZWxzZWlmICgkdmVyc2lvbl9pbmZvWzFdID09ICRtaW5vcikgeyBpZiAoJHZlcnNpb25faW5mb1syXSA+PSAkcmV2aXNpb24pIHsgcmV0dXJuIHRydWU7IH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfSB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0gfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9IH0gcHVibGljIGZ1bmN0aW9uIGdldFByb2R1Y3RBdHRyaWJ1dGUoJGNvZGUpIHsgaWYgKCFpc3NldCgkdGhpcy0+cHJvZHVjdF9hdHRyaWJ1dGVzWyRjb2RlXSkpIHsgJGF0dHJpYnV0ZU1vZGVsID0gTWFnZTo6Z2V0TW9kZWwoJ2Vhdi9lbnRpdHlfYXR0cmlidXRlJyktPmxvYWRCeUNvZGUoJ2NhdGFsb2dfcHJvZHVjdCcsICRjb2RlKTsgJGF0dHJpYnV0ZSA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL3Jlc291cmNlX2Vhdl9hdHRyaWJ1dGUnKS0+bG9hZCgkYXR0cmlidXRlTW9kZWwtPmdldElkKCkpOyAkdGhpcy0+cHJvZHVjdF9hdHRyaWJ1dGVzWyRjb2RlXSA9ICRhdHRyaWJ1dGU7IH0gcmV0dXJuICR0aGlzLT5wcm9kdWN0X2F0dHJpYnV0ZXNbJGNvZGVdOyB9IH0="));