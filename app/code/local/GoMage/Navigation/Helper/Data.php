<?php eval(base64_decode("LyoqICogR29NYWdlIEFkdmFuY2VkIE5hdmlnYXRpb24gRXh0ZW5zaW9uICogKiBAY2F0ZWdvcnkgRXh0ZW5zaW9uICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTAtMjAxNCBHb01hZ2UgKGh0dHA6Ly93d3cuZ29tYWdlLmNvbSkgKiBAYXV0aG9yIEdvTWFnZSAqIEBsaWNlbnNlIGh0dHA6Ly93d3cuZ29tYWdlLmNvbS9saWNlbnNlLWFncmVlbWVudC8gU2luZ2xlIGRvbWFpbiBsaWNlbnNlICogQHRlcm1zIG9mIHVzZSBodHRwOi8vd3d3LmdvbWFnZS5jb20vdGVybXMtb2YtdXNlICogQHZlcnNpb24gUmVsZWFzZTogNC40ICogQHNpbmNlIENsYXNzIGF2YWlsYWJsZSBzaW5jZSBSZWxlYXNlIDEuMCAqLyByZXF1aXJlX29uY2UoTWFnZTo6Z2V0QmFzZURpcignbGliJykgLiBEUyAuICdHb01hZ2UnIC4gRFMgLiAnTW9iaWxlRGV0ZWN0JyAuIERTIC4gJ01vYmlsZV9EZXRlY3QucGhwJyk7IGNsYXNzIEdvTWFnZV9OYXZpZ2F0aW9uX0hlbHBlcl9EYXRhIGV4dGVuZHMgTWFnZV9Db3JlX0hlbHBlcl9BYnN0cmFjdCB7IHB1YmxpYyBmdW5jdGlvbiBnZXRDb25maWdEYXRhKCRub2RlKSB7IHJldHVybiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vJyAuICRub2RlKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QWxsU3RvcmVEb21haW5zKCkgeyAkZG9tYWlucyA9IGFycmF5KCk7IGZvcmVhY2ggKE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlcygpIGFzICR3ZWJzaXRlKSB7ICR1cmwgPSAkd2Vic2l0ZS0+Z2V0Q29uZmlnKCd3ZWIvdW5zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gJHVybCA9ICR3ZWJzaXRlLT5nZXRDb25maWcoJ3dlYi9zZWN1cmUvYmFzZV91cmwnKTsgaWYgKCRkb21haW4gPSB0cmltKHByZWdfcmVwbGFjZSgnL14uKj9cXC9cXC8oLiopP1xcLy8nLCAnJDEnLCAkdXJsKSkpIHsgJGRvbWFpbnNbXSA9ICRkb21haW47IH0gfSByZXR1cm4gYXJyYXlfdW5pcXVlKCRkb21haW5zKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhYmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSB7IHJldHVybiAkdGhpcy0+X3coKTsgfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX3coKSB7IGlmICghTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi9pbnN0YWxsZWQnKSB8fCAoaW50dmFsKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vY291bnQnKSkgPiAxMCkgKSB7IHJldHVybiBhcnJheSgpOyB9ICR0aW1lX3RvX3VwZGF0ZSA9IDYwICogNjAgKiAyNCAqIDE1OyAkciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vYXInKTsgJHQgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3RpbWUnKTsgJHMgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL3dlYnNpdGVzJyk7ICRsYXN0X2NoZWNrID0gc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkdCkpOyAkYWxsc2l0ZXMgPSBleHBsb2RlKCcsJywgc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkcykpKTsgJGFsbHNpdGVzID0gYXJyYXlfZGlmZigkYWxsc2l0ZXMsIGFycmF5KCIiKSk7IGlmICgoJGxhc3RfY2hlY2sgKyAkdGltZV90b191cGRhdGUpIDwgdGltZSgpKSB7ICR0aGlzLT5hKE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24va2V5JyksIGludHZhbChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2NvdW50JykpLCBpbXBsb2RlKCcsJywgJGFsbHNpdGVzKSApOyB9IHJldHVybiAkYWxsc2l0ZXM7IH0gcHVibGljIGZ1bmN0aW9uIGEoJGssICRjID0gMCwgJHMgPSAnJykgeyAkY2ggPSBjdXJsX2luaXQoKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1VSTCwgc3ByaW50ZignaHR0cHM6Ly93d3cuZ29tYWdlLmNvbS9pbmRleC5waHAvZ29tYWdlX2Rvd25sb2FkYWJsZS9rZXkvY2hlY2snKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9QT1NULCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1RGSUVMRFMsICdrZXk9JyAuIHVybGVuY29kZSgkaykgLiAnJnNrdT1hZHZhbmNlZC1uYXZpZ2F0aW9uJmRvbWFpbnM9JyAuIHVybGVuY29kZShpbXBsb2RlKCcsJywgJHRoaXMtPmdldEFsbFN0b3JlRG9tYWlucygpKSkgLiAnJnZlcj0nIC4gdXJsZW5jb2RlKCc0LjMnKSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9USU1FT1VULCAzMCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9SRVRVUk5UUkFOU0ZFUiwgdHJ1ZSk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZUEVFUiwgMCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9TU0xfVkVSSUZZSE9TVCwgMCk7ICRjb250ZW50ID0gY3VybF9leGVjKCRjaCk7ICRyID0gWmVuZF9Kc29uOjpkZWNvZGUoJGNvbnRlbnQpOyAkZSA9IE1hZ2U6OmhlbHBlcignY29yZScpOyBpZiAoZW1wdHkoJHIpKSB7ICR2YWx1ZTEgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2FyJyk7ICRncm91cHMgPSBhcnJheSggJ2FkdmFuY2VkbmF2aWdhdGlvbicgPT4gYXJyYXkoICdmaWVsZHMnID0+IGFycmF5KCAnYXInID0+IGFycmF5KCAndmFsdWUnID0+ICR2YWx1ZTEgKSwgJ3dlYnNpdGVzJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKU1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9hZHZhbmNlZG5hdmlnYXRpb24vd2Vic2l0ZXMnKSApLCAndGltZScgPT4gYXJyYXkoICd2YWx1ZScgPT4gKHN0cmluZykkZS0+ZW5jcnlwdCgkdmFsdWUxIC4gKHRpbWUoKSAtICg2MCAqIDYwICogMjQgKiAxNSAtIDE4MDApKSAuICR2YWx1ZTEpICksICdjb3VudCcgPT4gYXJyYXkoICd2YWx1ZScgPT4gJGMgKyAxKSApICkgKTsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWluaHRtbC9jb25maWdfZGF0YScpIC0+c2V0U2VjdGlvbignZ29tYWdlX2FjdGl2YXRpb24nKSAtPnNldEdyb3VwcygkZ3JvdXBzKSAtPnNhdmUoKTsgTWFnZTo6Z2V0Q29uZmlnKCktPnJlaW5pdCgpOyBNYWdlOjphcHAoKS0+cmVpbml0U3RvcmVzKCk7IHJldHVybjsgfSAkdmFsdWUxID0gJyc7ICR2YWx1ZTIgPSAnJzsgaWYgKGlzc2V0KCRyWydkJ10pICYmIGlzc2V0KCRyWydjJ10pKSB7ICR2YWx1ZTEgPSAkZS0+ZW5jcnlwdChiYXNlNjRfZW5jb2RlKFplbmRfSnNvbjo6ZW5jb2RlKCRyKSkpOyBpZiAoISRzKSB7ICRzID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2FkdmFuY2VkbmF2aWdhdGlvbi93ZWJzaXRlcycpOyB9ICRzID0gYXJyYXlfc2xpY2UoZXhwbG9kZSgnLCcsICRzKSwgMCwgJHJbJ2MnXSk7ICR2YWx1ZTIgPSAkZS0+ZW5jcnlwdCgkdmFsdWUxIC4gaW1wbG9kZSgnLCcsICRzKSAuICR2YWx1ZTEpOyB9ICRncm91cHMgPSBhcnJheSggJ2FkdmFuY2VkbmF2aWdhdGlvbicgPT4gYXJyYXkoICdmaWVsZHMnID0+IGFycmF5KCAnYXInID0+IGFycmF5KCAndmFsdWUnID0+ICR2YWx1ZTEgKSwgJ3dlYnNpdGVzJyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAoc3RyaW5nKSR2YWx1ZTIgKSwgJ3RpbWUnID0+IGFycmF5KCAndmFsdWUnID0+IChzdHJpbmcpJGUtPmVuY3J5cHQoJHZhbHVlMSAuIHRpbWUoKSAuICR2YWx1ZTEpICksICdpbnN0YWxsZWQnID0+IGFycmF5KCAndmFsdWUnID0+IDEgKSwgJ2NvdW50JyA9PiBhcnJheSggJ3ZhbHVlJyA9PiAwKSApICkgKTsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWluaHRtbC9jb25maWdfZGF0YScpIC0+c2V0U2VjdGlvbignZ29tYWdlX2FjdGl2YXRpb24nKSAtPnNldEdyb3VwcygkZ3JvdXBzKSAtPnNhdmUoKTsgTWFnZTo6Z2V0Q29uZmlnKCktPnJlaW5pdCgpOyBNYWdlOjphcHAoKS0+cmVpbml0U3RvcmVzKCk7IH0gcHVibGljIGZ1bmN0aW9uIGdhKCkgeyByZXR1cm4gWmVuZF9Kc29uOjpkZWNvZGUoYmFzZTY0X2RlY29kZShNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdChNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2FjdGl2YXRpb24vYWR2YW5jZWRuYXZpZ2F0aW9uL2FyJykpKSk7IH0gcHVibGljIGZ1bmN0aW9uIGlzR29tYWdlTmF2aWdhdGlvbigpIHsgaWYgKCR0aGlzLT5pc01vYmlsZURldmljZSgpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZ2VuZXJhbC9kaXNhYmxlX21vYmlsZScpKSB7IHJldHVybiBmYWxzZTsgfSByZXR1cm4gaW5fYXJyYXkoTWFnZTo6YXBwKCktPmdldFN0b3JlKCktPmdldFdlYnNpdGVJZCgpLCAkdGhpcy0+Z2V0QXZhaWxhdmVsV2Vic2l0ZXMoKSkgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWdGbGFnKCdnb21hZ2VfbmF2aWdhdGlvbi9nZW5lcmFsL21vZGUnKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uTWVudSgpIHsgcmV0dXJuIGluX2FycmF5KE1hZ2U6OmFwcCgpLT5nZXRTdG9yZSgpLT5nZXRXZWJzaXRlSWQoKSwgJHRoaXMtPmdldEF2YWlsYXZlbFdlYnNpdGVzKCkpICYmIE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vbWVudWJhcnNldHRpbmdzL25hdmlnYXRpb24nKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb21hZ2VOYXZpZ2F0aW9uQWpheCgpIHsgcmV0dXJuICR0aGlzLT5pc0dvbWFnZU5hdmlnYXRpb24oKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2dlbmVyYWwvcGFnZXInKSAmJiAoTWFnZTo6cmVnaXN0cnkoJ2N1cnJlbnRfY2F0ZWdvcnknKSB8fCAoTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCktPmdldFJvdXRlTmFtZSgpID09ICdjYXRhbG9nc2VhcmNoJyAmJiBNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Q29udHJvbGxlck5hbWUoKSAhPSAnYWR2YW5jZWQnKSk7IH0gcHVibGljIGZ1bmN0aW9uIGlzR29tYWdlTmF2aWdhdGlvbkNsZWFyQWpheCgpIHsgcmV0dXJuICR0aGlzLT5pc0dvbWFnZU5hdmlnYXRpb24oKSAmJiAoTWFnZTo6cmVnaXN0cnkoJ2N1cnJlbnRfY2F0ZWdvcnknKSB8fCAoTWFnZTo6YXBwKCktPmdldEZyb250Q29udHJvbGxlcigpLT5nZXRSZXF1ZXN0KCktPmdldFJvdXRlTmFtZSgpID09ICdjYXRhbG9nc2VhcmNoJyAmJiBNYWdlOjphcHAoKS0+Z2V0RnJvbnRDb250cm9sbGVyKCktPmdldFJlcXVlc3QoKS0+Z2V0Q29udHJvbGxlck5hbWUoKSAhPSAnYWR2YW5jZWQnKSk7IH0gcHVibGljIGZ1bmN0aW9uIGZvcm1hdENvbG9yKCR2YWx1ZSkgeyBpZiAoJHZhbHVlID0gcHJlZ19yZXBsYWNlKCcvW15hLXpBLVowLTlcc10vJywgJycsICR2YWx1ZSkpIHsgJHZhbHVlID0gJyMnIC4gJHZhbHVlOyB9IHJldHVybiAkdmFsdWU7IH0gcHVibGljIGZ1bmN0aW9uIGlzRnJlbmRseVVybCgpIHsgcmV0dXJuICR0aGlzLT5pc0dvbWFnZU5hdmlnYXRpb24oKSAmJiBNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlcl9zZXR0aW5ncy9mcmVuZGx5dXJsJykgJiYgISR0aGlzLT5pc0dvTWFnZVNlb0Jvb3N0ZXJFbmFibGVkKCk7IH0gcHVibGljIGZ1bmN0aW9uIGlzR29NYWdlU2VvQm9vc3RlckVuYWJsZWQoKSB7ICRfbW9kdWxlcyA9IE1hZ2U6OmdldENvbmZpZygpLT5nZXROb2RlKCdtb2R1bGVzJyktPmNoaWxkcmVuKCk7ICRfbW9kdWxlc0FycmF5ID0gKGFycmF5KSRfbW9kdWxlczsgaWYgKCFpc3NldCgkX21vZHVsZXNBcnJheVsnR29NYWdlX1Nlb0Jvb3N0ZXInXSkpIHsgcmV0dXJuIGZhbHNlOyB9IHJldHVybiAkX21vZHVsZXNBcnJheVsnR29NYWdlX1Nlb0Jvb3N0ZXInXS0+aXMoJ2FjdGl2ZScpOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRSZXF1ZXN0KCkgeyAkcmVxdWVzdCA9IE1hZ2U6OmFwcCgpLT5nZXRGcm9udENvbnRyb2xsZXIoKS0+Z2V0UmVxdWVzdCgpOyBpZiAoJHRoaXMtPmlzR29NYWdlU2VvQm9vc3RlckVuYWJsZWQoKSkgeyAkaGVscGVyID0gTWFnZTo6aGVscGVyKCdnb21hZ2Vfc2VvYm9vc3Rlci9sYXllcmVkJyk7ICRyZXF1ZXN0ID0gJGhlbHBlci0+Z2V0U2VwYXJhdG9yKCkgfHwgJGhlbHBlci0+Y2FuQWRkUmV3cml0ZVBhdGgoKSA/ICRoZWxwZXItPmdldFJlcXVlc3QoKSA6ICRyZXF1ZXN0OyB9IHJldHVybiAkcmVxdWVzdDsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0RmlsdGVyVXJsKCRyb3V0ZSA9ICcnLCAkcGFyYW1zID0gYXJyYXkoKSwgJGZpbHRlciA9IGZhbHNlKSB7IGlmICghJHRoaXMtPmlzRnJlbmRseVVybCgpKSB7ICR1cmwgPSBNYWdlOjpnZXRVcmwoJHJvdXRlLCAkcGFyYW1zKTsgJGFyciA9IHBhcnNlX3VybCgkdXJsKTsgJHF1ZXJ5U3RyaW5nID0gZmFsc2U7IGlmIChpc3NldCgkYXJyWydxdWVyeSddKSkgeyBwYXJzZV9zdHIoaHRtbHNwZWNpYWxjaGFyc19kZWNvZGUoJGFyclsncXVlcnknXSksICRwYXIpOyBpZiAoaXNzZXQoJHBhclsnYWpheCddKSkgeyB1bnNldCgkcGFyWydhamF4J10pOyB9ICRxdWVyeVN0cmluZyA9IGh0dHBfYnVpbGRfcXVlcnkoJHBhcik7IH0gJHBvcnQgPSAnJzsgaWYgKGlzc2V0KCRhcnJbJ3BvcnQnXSkgJiYgJGFyclsncG9ydCddICE9PSAnODAnKSB7ICRwb3J0ID0gJzonIC4gJGFyclsncG9ydCddOyB9ICR1cmwgPSAkYXJyWydzY2hlbWUnXSAuICc6Ly8nIC4gJGFyclsnaG9zdCddIC4gJHBvcnQgLiAkYXJyWydwYXRoJ10gLiAnPyc7IGlmICgkcXVlcnlTdHJpbmcpIHsgJHVybCAuPSAkcXVlcnlTdHJpbmc7IH0gcmV0dXJuICR1cmw7IH0gJG1vZGVsID0gTWFnZTo6Z2V0TW9kZWwoJ2NvcmUvdXJsJyk7ICRhdHRyID0gTWFnZTo6cmVnaXN0cnkoJ2dhbl9maWx0ZXJfYXR0cmlidXRlcycpOyBmb3JlYWNoICgkbW9kZWwtPmdldFJlcXVlc3QoKS0+Z2V0UXVlcnkoKSBhcyAkcGFyYW0gPT4gJHZhbHVlKSB7ICRhdHRyaWJ1dGVNb2RlbCA9IE1hZ2U6OmdldE1vZGVsKCdlYXYvZW50aXR5X2F0dHJpYnV0ZScpLT5sb2FkQnlDb2RlKCdjYXRhbG9nX3Byb2R1Y3QnLCAkcGFyYW0pOyBpZiAoJHBhcmFtID09ICdjYXQnKSB7ICR2YWx1ZXMgPSBleHBsb2RlKCcsJywgJHZhbHVlKTsgJHByZXBhcmVfdmFsdWVzID0gYXJyYXkoKTsgZm9yZWFjaCAoJHZhbHVlcyBhcyAkX3ZhbHVlKSB7ICRjYXRlZ29yeSA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL2NhdGVnb3J5JyktPmxvYWQoJF92YWx1ZSk7IGlmICgkY2F0ZWdvcnkgJiYgJGNhdGVnb3J5LT5nZXRJZCgpKSB7IGlmIChNYWdlOjpnZXRTdG9yZUNvbmZpZ0ZsYWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlcl9zZXR0aW5ncy9leHBlbmRfZnJlbmRseXVybCcpKSB7ICRwYXJlbnRfaWRzID0gJGNhdGVnb3J5LT5nZXRQYXJlbnRJZHMoKTsgJHBhcmVudF9jYXRlZ29yeSA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL2NhdGVnb3J5JyktPmxvYWQoZW5kKCRwYXJlbnRfaWRzKSk7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJHBhcmVudF9jYXRlZ29yeS0+Z2V0RGF0YSgndXJsX2tleScpIC4gJ3wnIC4gJGNhdGVnb3J5LT5nZXREYXRhKCd1cmxfa2V5Jyk7IH0gZWxzZSB7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJGNhdGVnb3J5LT5nZXREYXRhKCd1cmxfa2V5Jyk7IH0gfSB9ICRtb2RlbC0+Z2V0UmVxdWVzdCgpLT5zZXRRdWVyeSgkcGFyYW0sIGltcGxvZGUoJywnLCAkcHJlcGFyZV92YWx1ZXMpKTsgfSBlbHNlaWYgKGlzc2V0KCRhdHRyWyRwYXJhbV0pICYmICFpbl9hcnJheSgkYXR0clskcGFyYW1dWyd0eXBlJ10sIGFycmF5KCdwcmljZScsICdkZWNpbWFsJykpKSB7ICR2YWx1ZXMgPSBleHBsb2RlKCcsJywgJHZhbHVlKTsgJHByZXBhcmVfdmFsdWVzID0gYXJyYXkoKTsgZm9yZWFjaCAoJHZhbHVlcyBhcyAkX3ZhbHVlKSB7IGZvcmVhY2ggKCRhdHRyWyRwYXJhbV1bJ29wdGlvbnMnXSBhcyAkX2sgPT4gJF92KSB7IGlmICgkX3YgPT0gJF92YWx1ZSkgeyAkcHJlcGFyZV92YWx1ZXNbXSA9ICRfazsgYnJlYWs7IH0gfSB9ICRtb2RlbC0+Z2V0UmVxdWVzdCgpLT5zZXRRdWVyeSgkcGFyYW0sIGltcGxvZGUoJywnLCAkcHJlcGFyZV92YWx1ZXMpKTsgfSBlbHNlIHsgaWYgKCRhdHRyaWJ1dGVNb2RlbC0+Z2V0RnJvbnRlbmRJbnB1dCgpID09ICRwYXJhbSkgeyAkYXR0cmlidXRlID0gTWFnZTo6Z2V0TW9kZWwoJ2NhdGFsb2cvcmVzb3VyY2VfZWF2X2F0dHJpYnV0ZScpLT5sb2FkKCRhdHRyaWJ1dGVNb2RlbC0+Z2V0SWQoKSk7IGlmIChpc19hcnJheSgkdmFsdWUpKSB7IGlmIChpc3NldCgkdmFsdWVbJ2Zyb20nXSkpIHsgJHBhcmFtc1snX3F1ZXJ5J11bJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ19mcm9tJ10gPSAkdmFsdWVbJ2Zyb20nXTsgfSBpZiAoaXNzZXQoJHZhbHVlWyd0byddKSkgeyAkcGFyYW1zWydfcXVlcnknXVskYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCkgLiAnX3RvJ10gPSAkdmFsdWVbJ3RvJ107IH0gfSBlbHNlaWYgKCgkYXR0cmlidXRlLT5nZXRSYW5nZU9wdGlvbnMoKSA9PSBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9BZG1pbmh0bWxfU3lzdGVtX0NvbmZpZ19Tb3VyY2VfRmlsdGVyX09wdGlvbnNyYW5nZTo6TUFOVUFMTFkgfHwgJGF0dHJpYnV0ZS0+Z2V0UmFuZ2VPcHRpb25zKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6OkFVVE8pICYmICRhdHRyaWJ1dGUtPmdldEZpbHRlclR5cGUoKSA9PSBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9MYXllcjo6RklMVEVSX1RZUEVfREVGQVVMVCApIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcGFyYW1zWydfcXVlcnknXVskYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCkgLiAnX2Zyb20nXSA9ICR2YWx1ZXNbMF07ICRwYXJhbXNbJ19xdWVyeSddWyRhdHRyaWJ1dGUtPmdldEF0dHJpYnV0ZUNvZGUoKSAuICdfdG8nXSA9ICR2YWx1ZXNbMV07IHVuc2V0KCRwYXJhbXNbJ19xdWVyeSddWyRhdHRyaWJ1dGUtPmdldEF0dHJpYnV0ZUNvZGUoKV0pOyB9IGVsc2UgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7ICRwcmVwYXJlX3ZhbHVlcyA9IGFycmF5KCk7IGZvcmVhY2ggKCR2YWx1ZXMgYXMgJF92YWx1ZSkgeyBmb3JlYWNoICgkYXR0clskcGFyYW1dWydvcHRpb25zJ10gYXMgJF9rID0+ICRfdikgeyBpZiAoJF92ID09ICRfdmFsdWUpIHsgJHByZXBhcmVfdmFsdWVzW10gPSAkX2s7IGJyZWFrOyB9IH0gfSBpZiAoIWVtcHR5KCRwcmVwYXJlX3ZhbHVlcykpIHsgJG1vZGVsLT5nZXRSZXF1ZXN0KCktPnNldFF1ZXJ5KCRwYXJhbSwgaW1wbG9kZSgnLCcsICRwcmVwYXJlX3ZhbHVlcykpOyB9IH0gfSB9IH0gaWYgKGlzc2V0KCRwYXJhbXNbJ19xdWVyeSddKSkgeyBmb3JlYWNoICgkcGFyYW1zWydfcXVlcnknXSBhcyAkcGFyYW0gPT4gJHZhbHVlKSB7IGlmICgkdmFsdWUpIHsgJGF0dHJpYnV0ZU1vZGVsID0gTWFnZTo6Z2V0TW9kZWwoJ2Vhdi9lbnRpdHlfYXR0cmlidXRlJyktPmxvYWRCeUNvZGUoJ2NhdGFsb2dfcHJvZHVjdCcsICRwYXJhbSk7IGlmICgkcGFyYW0gPT0gJ2NhdCcpIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcHJlcGFyZV92YWx1ZXMgPSBhcnJheSgpOyBmb3JlYWNoICgkdmFsdWVzIGFzICRfdmFsdWUpIHsgJGNhdGVnb3J5ID0gTWFnZTo6Z2V0TW9kZWwoJ2NhdGFsb2cvY2F0ZWdvcnknKS0+bG9hZCgkX3ZhbHVlKTsgaWYgKCRjYXRlZ29yeSAmJiAkY2F0ZWdvcnktPmdldElkKCkpIHsgaWYgKE1hZ2U6OmdldFN0b3JlQ29uZmlnRmxhZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyX3NldHRpbmdzL2V4cGVuZF9mcmVuZGx5dXJsJykpIHsgJHBhcmVudF9pZHMgPSAkY2F0ZWdvcnktPmdldFBhcmVudElkcygpOyAkcGFyZW50X2NhdGVnb3J5ID0gTWFnZTo6Z2V0TW9kZWwoJ2NhdGFsb2cvY2F0ZWdvcnknKS0+bG9hZChlbmQoJHBhcmVudF9pZHMpKTsgJHByZXBhcmVfdmFsdWVzW10gPSAkcGFyZW50X2NhdGVnb3J5LT5nZXREYXRhKCd1cmxfa2V5JykgLiAnfCcgLiAkY2F0ZWdvcnktPmdldERhdGEoJ3VybF9rZXknKTsgfSBlbHNlIHsgJHByZXBhcmVfdmFsdWVzW10gPSAkY2F0ZWdvcnktPmdldERhdGEoJ3VybF9rZXknKTsgfSB9IH0gJHBhcmFtc1snX3F1ZXJ5J11bJHBhcmFtXSA9IGltcGxvZGUoJywnLCAkcHJlcGFyZV92YWx1ZXMpOyB9IGVsc2VpZiAoaXNzZXQoJGF0dHJbJHBhcmFtXSkgJiYgIWluX2FycmF5KCRhdHRyWyRwYXJhbV1bJ3R5cGUnXSwgYXJyYXkoJ3ByaWNlJywgJ2RlY2ltYWwnKSkpIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcHJlcGFyZV92YWx1ZXMgPSBhcnJheSgpOyBmb3JlYWNoICgkdmFsdWVzIGFzICRfdmFsdWUpIHsgZm9yZWFjaCAoJGF0dHJbJHBhcmFtXVsnb3B0aW9ucyddIGFzICRfayA9PiAkX3YpIHsgaWYgKCRfdiA9PSAkX3ZhbHVlKSB7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJF9rOyBicmVhazsgfSB9IH0gJHBhcmFtc1snX3F1ZXJ5J11bJHBhcmFtXSA9IGltcGxvZGUoJywnLCAkcHJlcGFyZV92YWx1ZXMpOyB9IGVsc2UgeyBpZiAoJGF0dHJpYnV0ZU1vZGVsLT5nZXRGcm9udGVuZElucHV0KCkgPT0gJHBhcmFtKSB7ICRhdHRyaWJ1dGUgPSBNYWdlOjpnZXRNb2RlbCgnY2F0YWxvZy9yZXNvdXJjZV9lYXZfYXR0cmlidXRlJyktPmxvYWQoJGF0dHJpYnV0ZU1vZGVsLT5nZXRJZCgpKTsgaWYgKCgkYXR0cmlidXRlLT5nZXRSYW5nZU9wdGlvbnMoKSA9PSBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9BZG1pbmh0bWxfU3lzdGVtX0NvbmZpZ19Tb3VyY2VfRmlsdGVyX09wdGlvbnNyYW5nZTo6TUFOVUFMTFkgfHwgJGF0dHJpYnV0ZS0+Z2V0UmFuZ2VPcHRpb25zKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6OkFVVE8pICYmICRhdHRyaWJ1dGUtPmdldEZpbHRlclR5cGUoKSA9PSBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9MYXllcjo6RklMVEVSX1RZUEVfREVGQVVMVCApIHsgaWYgKHN0cnBvcygkdmFsdWUsICc7JykpIHsgJHZhbHVlcyA9IGV4cGxvZGUoJzsnLCAkdmFsdWUpOyB9IGVsc2UgeyAkdmFsdWVzID0gZXhwbG9kZSgnLCcsICR2YWx1ZSk7IH0gJHBhcmFtc1snX3F1ZXJ5J11bJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ19mcm9tJ10gPSAkdmFsdWVzWzBdOyAkcGFyYW1zWydfcXVlcnknXVskYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCkgLiAnX3RvJ10gPSAkdmFsdWVzWzFdOyB1bnNldCgkcGFyYW1zWydfcXVlcnknXVskYXR0cmlidXRlLT5nZXRBdHRyaWJ1dGVDb2RlKCldKTsgfSBlbHNlIHsgJHZhbHVlcyA9IGV4cGxvZGUoJywnLCAkdmFsdWUpOyAkcHJlcGFyZV92YWx1ZXMgPSBhcnJheSgpOyBmb3JlYWNoICgkdmFsdWVzIGFzICRfdmFsdWUpIHsgZm9yZWFjaCAoJGF0dHJbJHBhcmFtXVsnb3B0aW9ucyddIGFzICRfayA9PiAkX3YpIHsgaWYgKCRfdiA9PSAkX3ZhbHVlKSB7ICRwcmVwYXJlX3ZhbHVlc1tdID0gJF9rOyBicmVhazsgfSB9IH0gaWYgKCFlbXB0eSgkcHJlcGFyZV92YWx1ZXMpKSB7ICRwYXJhbXNbJ19xdWVyeSddWyRwYXJhbV0gPSBpbXBsb2RlKCcsJywgJHByZXBhcmVfdmFsdWVzKTsgfSB9IH0gfSB9IH0gfSAkdXJsID0gJG1vZGVsLT5nZXRVcmwoJHJvdXRlLCAkcGFyYW1zKTsgJGFyciA9IHBhcnNlX3VybCgkdXJsKTsgJHF1ZXJ5U3RyaW5nID0gZmFsc2U7IGlmIChpc3NldCgkYXJyWydxdWVyeSddKSkgeyBwYXJzZV9zdHIoaHRtbHNwZWNpYWxjaGFyc19kZWNvZGUoJGFyclsncXVlcnknXSksICRwYXIpOyBpZiAoaXNzZXQoJHBhclsnYWpheCddKSkgeyB1bnNldCgkcGFyWydhamF4J10pOyB9ICRxdWVyeVN0cmluZyA9IGh0dHBfYnVpbGRfcXVlcnkoJHBhcik7IH0gJHVybCA9ICRhcnJbJ3NjaGVtZSddIC4gJzovLycgLiAkYXJyWydob3N0J10gLiAkYXJyWydwYXRoJ10gLiAnPyc7IGlmICgkcXVlcnlTdHJpbmcpIHsgJHVybCAuPSAkcXVlcnlTdHJpbmc7IH0gcmV0dXJuICR1cmw7IH0gcHVibGljIGZ1bmN0aW9uIGZvcm1hdFVybFZhbHVlKCR2YWx1ZSwgJGRlZmF1bHQpIHsgJG9sZExvY2FsZSA9IHNldGxvY2FsZShMQ19DT0xMQVRFLCAiMCIpOyAkbG9jYWxlQ29kZSA9IE1hZ2U6OmFwcCgpLT5nZXRMb2NhbGUoKS0+Z2V0TG9jYWxlQ29kZSgpOyBzZXRsb2NhbGUoTENfQ09MTEFURSwgJGxvY2FsZUNvZGUgLiAnLlVURjgnLCAnQy5VVEYtOCcsICdlbl9VUy51dGY4Jyk7ICR2YWx1ZSA9IGljb252KG1iX2RldGVjdF9lbmNvZGluZygkdmFsdWUpLCAnQVNDSUkvL1RSQU5TTElUJywgJHZhbHVlKTsgc2V0bG9jYWxlKExDX0NPTExBVEUsICRvbGRMb2NhbGUpOyAkdmFsdWUgPSBzdHJ0b2xvd2VyKCR2YWx1ZSk7ICR2YWx1ZSA9IHByZWdfcmVwbGFjZSgnI1teMC05YS16XSsjaScsICctJywgTWFnZTo6aGVscGVyKCdjYXRhbG9nL3Byb2R1Y3RfdXJsJyktPmZvcm1hdCgkdmFsdWUpKTsgJHZhbHVlID0gdHJpbSgkdmFsdWUsICctJyk7IHJldHVybiAkdmFsdWUgPyAkdmFsdWUgOiAkZGVmYXVsdDsgfSBwdWJsaWMgZnVuY3Rpb24gaXNNb2JpbGVEZXZpY2UoKSB7ICRkZXRlY3QgPSBuZXcgTW9iaWxlX0RldGVjdCgpOyByZXR1cm4gJGRldGVjdC0+aXNNb2JpbGUoKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNHb29nbGVib3QoKSB7IGlmIChwcmVnX21hdGNoKCIvR29vZ2xlLyIsIE1hZ2U6OmhlbHBlcignY29yZS9odHRwJyktPmdldEh0dHBVc2VyQWdlbnQoKSkgfHwgcHJlZ19tYXRjaCgiL2JvdC8iLCBNYWdlOjpoZWxwZXIoJ2NvcmUvaHR0cCcpLT5nZXRIdHRwVXNlckFnZW50KCkpKSB7ICRpcCA9IE1hZ2U6OmhlbHBlcignY29yZS9odHRwJyktPmdldFJlbW90ZUFkZHIoKTsgJG5hbWUgPSBnZXRob3N0YnlhZGRyKCRpcCk7IGlmIChwcmVnX21hdGNoKCIvR29vZ2xlYm90LyIsICRuYW1lKSB8fCBwcmVnX21hdGNoKCIvYm90LyIsICRuYW1lKSkgeyAkaG9zdHMgPSBnZXRob3N0YnluYW1lbCgkbmFtZSk7IGZvcmVhY2ggKCRob3N0cyBhcyAkaG9zdCkgeyBpZiAoJGhvc3QgPT0gJGlwKSB7IHJldHVybiB0cnVlOyB9IH0gfSB9IGVsc2UgeyByZXR1cm4gdHJ1ZTsgfSByZXR1cm4gZmFsc2U7IH0gcHVibGljIGZ1bmN0aW9uIGdldEZpbHRlckl0ZW1Db3VudCgkZmlsdGVyKSB7ICRjb3VudCA9IDA7IGlmICgkZmlsdGVyICYmICRmaWx0ZXItPmdldEl0ZW1zKCkpIHsgZm9yZWFjaCAoJGZpbHRlci0+Z2V0SXRlbXMoKSBhcyAkaXRlbSkgeyAkY291bnQgKz0gJGl0ZW0tPmdldENvdW50KCk7IH0gfSBpZiAoJGNvdW50ID09IDAgJiYgJGZpbHRlci0+Z2V0RmlsdGVyKCktPmdldFJlcXVlc3RWYXJWYWx1ZSgpID09ICdzdG9ja19zdGF0dXMnKSB7IHJldHVybiAxOyB9IHJldHVybiAkY291bnQ7IH0gcHVibGljIGZ1bmN0aW9uIGdldEZpbHRlcigpIHsgJGZpbHRlciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvZmlsdGVyX2J0bl90eHQnKTsgaWYgKCRmaWx0ZXIgPT0gJycpIHsgJGZpbHRlciA9ICR0aGlzLT5fXygnRmlsdGVyJyk7IH0gcmV0dXJuICRmaWx0ZXI7IH0gcHVibGljIGZ1bmN0aW9uIGdldENsZWFyQWxsKCkgeyAkY2xlYXIgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX25hdmlnYXRpb24vZmlsdGVyL2NsZWFyX2J0bl90eHQnKTsgaWYgKCRjbGVhciA9PSAnJykgeyAkY2xlYXIgPSAkdGhpcy0+X18oJ0NsZWFyIEFsbCcpOyB9IHJldHVybiAkY2xlYXI7IH0gcHVibGljIGZ1bmN0aW9uIGdldE1vcmUoKSB7ICRtb3JlID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9tb3JlX2J0bl90eHQnKTsgaWYgKCRtb3JlID09ICcnKSB7ICRtb3JlID0gJHRoaXMtPl9fKCdNb3JlJyk7IH0gcmV0dXJuICRtb3JlOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRMZXNzKCkgeyAkbGVzcyA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvbGVzc19idG5fdHh0Jyk7IGlmICgkbGVzcyA9PSAnJykgeyAkbGVzcyA9ICR0aGlzLT5fXygnTGVzcycpOyB9IHJldHVybiAkbGVzczsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0U2hvd21vcmUoKSB7ICRzaG93bW9yZSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfbmF2aWdhdGlvbi9maWx0ZXIvc2hvd21vcmVfYnRuX3R4dCcpOyBpZiAoJHNob3dtb3JlID09ICcnKSB7ICRzaG93bW9yZSA9ICR0aGlzLT5fXygnU2hvdyBtb3JlIHByb2R1Y3RzJyk7IH0gcmV0dXJuICRzaG93bW9yZTsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0QmFja3RvdG9wKCkgeyAkYmFja3RvdG9wID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2ZpbHRlci9iYWNrdG90b3BfYnRuX3R4dCcpOyBpZiAoJGJhY2t0b3RvcCA9PSAnJykgeyAkYmFja3RvdG9wID0gJHRoaXMtPl9fKCdCYWNrIHRvIFRvcCcpOyB9IHJldHVybiAkYmFja3RvdG9wOyB9IHB1YmxpYyBmdW5jdGlvbiBpc0VudGVycHJpc2UoKSB7IGlmIChNYWdlOjpnZXRDb25maWcoKS0+Z2V0TW9kdWxlQ29uZmlnKCdFbnRlcnByaXNlX0VudGVycHJpc2UnKSAmJiBNYWdlOjpnZXRDb25maWcoKS0+Z2V0TW9kdWxlQ29uZmlnKCdFbnRlcnByaXNlX0FkbWluR3dzJykgJiYgTWFnZTo6Z2V0Q29uZmlnKCktPmdldE1vZHVsZUNvbmZpZygnRW50ZXJwcmlzZV9DaGVja291dCcpICYmIE1hZ2U6OmdldENvbmZpZygpLT5nZXRNb2R1bGVDb25maWcoJ0VudGVycHJpc2VfQ3VzdG9tZXInKSkgeyByZXR1cm4gdHJ1ZTsgfSByZXR1cm4gZmFsc2U7IH0gcHVibGljIGZ1bmN0aW9uIGdldFNpZGUoJHR5cGUpIHsgc3dpdGNoICgkdHlwZSkgeyBjYXNlIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfQXR0cmlidXRlbG9jYXRpb246OkxFRlRfQkxPQ0s6IHJldHVybiAnbGVmdCc7IGJyZWFrOyBjYXNlIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfQXR0cmlidXRlbG9jYXRpb246OkNPTlRFTlQ6IHJldHVybiAnY29udGVudCc7IGJyZWFrOyBjYXNlIEdvTWFnZV9OYXZpZ2F0aW9uX01vZGVsX0FkbWluaHRtbF9TeXN0ZW1fQ29uZmlnX1NvdXJjZV9GaWx0ZXJfQXR0cmlidXRlbG9jYXRpb246OlJJR0hUX0JMT0NLOiByZXR1cm4gJ3JpZ2h0JzsgYnJlYWs7IGRlZmF1bHQ6IHJldHVybiAnbGVmdCc7IGJyZWFrOyB9IH0gcHVibGljIGZ1bmN0aW9uIGdldENsZWFyTGlua1VybCgkX2ZpbHRlcikgeyBpZiAoJF9maWx0ZXItPmdldEZpbHRlcigpLT5nZXRSZXF1ZXN0VmFyKCkgIT0gJ2NhdCcgJiYgJF9maWx0ZXItPmdldEZpbHRlcigpLT5nZXRSZXF1ZXN0VmFyKCkgIT0gJ3N0b2NrX3N0YXR1cycpIHsgaWYgKCRfZmlsdGVyLT5nZXRGaWx0ZXIoKS0+Z2V0QXR0cmlidXRlTW9kZWwoKS0+Z2V0RnJvbnRlbmRJbnB1dCgpKSB7ICRhdHRyaWJ1dGUgPSAkX2ZpbHRlci0+Z2V0RmlsdGVyKCktPmdldEF0dHJpYnV0ZU1vZGVsKCk7IGlmICgoaW5fYXJyYXkoJGF0dHJpYnV0ZS0+Z2V0RmlsdGVyVHlwZSgpLCBhcnJheShHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9MYXllcjo6RklMVEVSX1RZUEVfU0xJREVSLCBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9MYXllcjo6RklMVEVSX1RZUEVfU0xJREVSX0lOUFVULCBHb01hZ2VfTmF2aWdhdGlvbl9Nb2RlbF9MYXllcjo6RklMVEVSX1RZUEVfSU5QVVRfU0xJREVSKSApICYmICFNYWdlOjpoZWxwZXIoJ2dvbWFnZV9uYXZpZ2F0aW9uJyktPmlzTW9iaWxlRGV2aWNlKCkpIHx8ICgkYXR0cmlidXRlLT5nZXRGaWx0ZXJUeXBlKCkgPT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfTGF5ZXI6OkZJTFRFUl9UWVBFX0RFRkFVTFQgJiYgJGF0dHJpYnV0ZS0+Z2V0UmFuZ2VPcHRpb25zKCkgIT0gR29NYWdlX05hdmlnYXRpb25fTW9kZWxfQWRtaW5odG1sX1N5c3RlbV9Db25maWdfU291cmNlX0ZpbHRlcl9PcHRpb25zcmFuZ2U6Ok5PKSApIHsgJHBhcmFtcyA9IGFycmF5KCk7ICRwYXJhbXNbJ19ub3NpZCddID0gdHJ1ZTsgJHBhcmFtc1snX2N1cnJlbnQnXSA9IHRydWU7ICRwYXJhbXNbJ191c2VfcmV3cml0ZSddID0gdHJ1ZTsgJHBhcmFtc1snX2VzY2FwZSddID0gZmFsc2U7ICR1cmwgPSAkdGhpcy0+Z2V0RmlsdGVyVXJsKCcqLyovKicsICRwYXJhbXMpOyAkY2xlYW5fdXJsID0gJHRoaXMtPmdldEZpbHRlclVybCgnKi8qLyonLCBhcnJheSgnX2N1cnJlbnQnID0+IHRydWUsICdfbm9zaWQnID0+IHRydWUsICdfdXNlX3Jld3JpdGUnID0+IHRydWUsICdfcXVlcnknID0+IGFycmF5KCksICdfZXNjYXBlJyA9PiBmYWxzZSkpOyBpZiAoc3RycG9zKCRjbGVhbl91cmwsICI/IikgIT09IGZhbHNlKSB7ICRjbGVhbl91cmwgPSBzdWJzdHIoJGNsZWFuX3VybCwgMCwgc3RycG9zKCRjbGVhbl91cmwsICc/JykpOyB9ICRwYXJhbXMgPSBzdHJfcmVwbGFjZSgkY2xlYW5fdXJsLCAiIiwgJHVybCk7ICRwYXJhbXMgPSBzdHJfcmVwbGFjZSgiPyIsICIiLCAkcGFyYW1zKTsgJHBhckFycmF5ID0gZXhwbG9kZSgiJiIsICRwYXJhbXMpOyAkbmV3UGFyQXJyYXkgPSBhcnJheSgpOyBmb3JlYWNoICgkcGFyQXJyYXkgYXMgJHBhcikgeyAkZXhwYXIgPSBleHBsb2RlKCI9IiwgJHBhcik7IGlmICgkZXhwYXJbMF0gIT0gJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ19mcm9tJyAmJiAkZXhwYXJbMF0gIT0gJGF0dHJpYnV0ZS0+Z2V0QXR0cmlidXRlQ29kZSgpIC4gJ190bycgKSB7ICRuZXdQYXJBcnJheVtdID0gJHBhcjsgfSB9IGlmICgkbmV3UGFyQXJyYXkpIHsgaWYgKCRfZmlsdGVyLT5nZXRBamF4RW5hYmxlZCgpKSB7IHJldHVybiAkY2xlYW5fdXJsIC4gJz8nIC4gaW1wbG9kZSgiJiIsICRuZXdQYXJBcnJheSkgLiAnJmFqYXg9MSc7IH0gZWxzZSB7IHJldHVybiAkY2xlYW5fdXJsIC4gJz8nIC4gaW1wbG9kZSgiJiIsICRuZXdQYXJBcnJheSk7IH0gfSBlbHNlIHsgaWYgKCRfZmlsdGVyLT5nZXRBamF4RW5hYmxlZCgpKSB7IHJldHVybiAkY2xlYW5fdXJsIC4gJz9hamF4PTEnOyB9IGVsc2UgeyByZXR1cm4gJGNsZWFuX3VybDsgfSB9IH0gfSBlbHNlIHsgcmV0dXJuICRfZmlsdGVyLT5nZXRDbGVhckxpbmtVcmwoKTsgfSB9IGVsc2UgeyByZXR1cm4gJF9maWx0ZXItPmdldENsZWFyTGlua1VybCgpOyB9IH0gcHVibGljIGZ1bmN0aW9uIG5vdGlmeSgpIHsgJGZyZXF1ZW5jeSA9IGludHZhbChNYWdlOjphcHAoKS0+bG9hZENhY2hlKCdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKSk7IGlmICghJGZyZXF1ZW5jeSkgeyAkZnJlcXVlbmN5ID0gMjQ7IH0gJGxhc3RfdXBkYXRlID0gaW50dmFsKE1hZ2U6OmFwcCgpLT5sb2FkQ2FjaGUoJ2dvbWFnZV9ub3RpZmljYXRpb25zX2xhc3RfdXBkYXRlJykpOyBpZiAoKCRmcmVxdWVuY3kgKiA2MCAqIDYwICsgJGxhc3RfdXBkYXRlKSA+IHRpbWUoKSkgeyByZXR1cm4gZmFsc2U7IH0gJHRpbWVzdGFtcCA9ICRsYXN0X3VwZGF0ZTsgaWYgKCEkdGltZXN0YW1wKSB7ICR0aW1lc3RhbXAgPSB0aW1lKCk7IH0gdHJ5IHsgJGNoID0gY3VybF9pbml0KCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsIHNwcmludGYoJ2h0dHBzOi8vd3d3LmdvbWFnZS5jb20vaW5kZXgucGhwL2dvbWFnZV9ub3RpZmljYXRpb24vaW5kZXgvZGF0YScpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVEZJRUxEUywgJ3NrdT1hZHZhbmNlZC1uYXZpZ2F0aW9uJnRpbWVzdGFtcD0nIC4gJHRpbWVzdGFtcCAuICcmdmVyPScgLiB1cmxlbmNvZGUoJzQuMycpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDMwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllIT1NULCAwKTsgJGNvbnRlbnQgPSBjdXJsX2V4ZWMoJGNoKTsgJHJlc3VsdCA9IFplbmRfSnNvbjo6ZGVjb2RlKCRjb250ZW50KTsgaWYgKCRyZXN1bHQgJiYgaXNzZXQoJHJlc3VsdFsnZnJlcXVlbmN5J10pICYmICgkcmVzdWx0WydmcmVxdWVuY3knXSAhPSAkZnJlcXVlbmN5KSkgeyBNYWdlOjphcHAoKS0+c2F2ZUNhY2hlKCRyZXN1bHRbJ2ZyZXF1ZW5jeSddLCAnZ29tYWdlX25vdGlmaWNhdGlvbnNfZnJlcXVlbmN5Jyk7IH0gaWYgKCRyZXN1bHQgJiYgaXNzZXQoJHJlc3VsdFsnZGF0YSddKSkgeyBpZiAoIWVtcHR5KCRyZXN1bHRbJ2RhdGEnXSkpIHsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWlubm90aWZpY2F0aW9uL2luYm94JyktPnBhcnNlKCRyZXN1bHRbJ2RhdGEnXSk7IH0gfSB9IGNhdGNoIChFeGNlcHRpb24gJGUpIHsgfSBNYWdlOjphcHAoKS0+c2F2ZUNhY2hlKHRpbWUoKSwgJ2dvbWFnZV9ub3RpZmljYXRpb25zX2xhc3RfdXBkYXRlJyk7IH0gcHVibGljIGZ1bmN0aW9uIGdldElzQW55bW9yZVZlcnNpb24oJG1ham9yLCAkbWlub3IsICRyZXZpc2lvbiA9IDApIHsgJHZlcnNpb25faW5mbyA9IE1hZ2U6OmdldFZlcnNpb24oKTsgJHZlcnNpb25faW5mbyA9IGV4cGxvZGUoJy4nLCAkdmVyc2lvbl9pbmZvKTsgaWYgKCR2ZXJzaW9uX2luZm9bMF0gPiAkbWFqb3IpIHsgcmV0dXJuIHRydWU7IH0gZWxzZWlmICgkdmVyc2lvbl9pbmZvWzBdID09ICRtYWpvcikgeyBpZiAoJHZlcnNpb25faW5mb1sxXSA+ICRtaW5vcikgeyByZXR1cm4gdHJ1ZTsgfSBlbHNlaWYgKCR2ZXJzaW9uX2luZm9bMV0gPT0gJG1pbm9yKSB7IGlmICgkdmVyc2lvbl9pbmZvWzJdID49ICRyZXZpc2lvbikgeyByZXR1cm4gdHJ1ZTsgfSBlbHNlIHsgcmV0dXJuIGZhbHNlOyB9IH0gZWxzZSB7IHJldHVybiBmYWxzZTsgfSB9IGVsc2UgeyByZXR1cm4gZmFsc2U7IH0gfSB9"));